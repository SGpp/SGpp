// Copyright (C) 2008-today The SG++ project
// This file is part of the SG++ project. For conditions of distribution and
// use, please see the copyright notice provided with SG++ or at
// sgpp.sparsegrids.org

#ifndef FUNDAMENTAL_NOTAKNOT_SPLINE_BASE_HPP
#define FUNDAMENTAL_NOTAKNOT_SPLINE_BASE_HPP

#include <sgpp/base/operation/hash/common/basis/Basis.hpp>
#include <sgpp/base/operation/hash/common/basis/NotAKnotBsplineBasis.hpp>
#include <sgpp/base/operation/hash/common/basis/NotAKnotBsplineBasisDeriv1.hpp>
#include <sgpp/base/operation/hash/common/basis/NotAKnotBsplineBasisDeriv2.hpp>
#include <sgpp/base/operation/hash/common/basis/FundamentalSplineBasis.hpp>

#include <sgpp/globaldef.hpp>

#include <algorithm>
#include <cmath>
#include <stdexcept>
#include <vector>

namespace sgpp {
namespace base {

/**
 * Fundamental not-a-knot spline basis.
 */
template <class LT, class IT>
class FundamentalNotAKnotSplineBasis: public Basis<LT, IT> {
 public:
  /**
   * Default constructor.
   */
  FundamentalNotAKnotSplineBasis():
    notAKnotBsplineBasis(NotAKnotBsplineBasis<LT, IT>()),
    notAKnotBsplineBasisDeriv1(NotAKnotBsplineBasisDeriv1<LT, IT>()),
    notAKnotBsplineBasisDeriv2(NotAKnotBsplineBasisDeriv2<LT, IT>()),
    fundamentalSplineBasis(FundamentalSplineBasis<LT, IT>()) {
  }

  /**
   * Constructor.
   *
   * @param degree    spline degree, must be odd
   *                  (if it's even, degree - 1 is used)
   */
  explicit FundamentalNotAKnotSplineBasis(size_t degree) :
    notAKnotBsplineBasis(NotAKnotBsplineBasis<LT, IT>(degree)),
    notAKnotBsplineBasisDeriv1(NotAKnotBsplineBasisDeriv1<LT, IT>(degree)),
    notAKnotBsplineBasisDeriv2(NotAKnotBsplineBasisDeriv2<LT, IT>(degree)),
    fundamentalSplineBasis(FundamentalSplineBasis<LT, IT>(degree)) {
  }

  /**
   * Destructor.
   */
  ~FundamentalNotAKnotSplineBasis() override {
  }

  int getCoefficients(LT l, IT i, std::vector<double>& coefficients) {
    const size_t p = notAKnotBsplineBasis.getDegree();
    const double hInv = static_cast<double>(static_cast<IT>(1) << l);

    if (i > hInv / 2) {
      throw std::invalid_argument("Index must not be greater than hInv / 2.");
    } else if ((l > 0) && (i % 2 == 0)) {
      throw std::invalid_argument("Index must not be even.");
    }

    if (p == 1) {
      return -2;

    } else if (p == 3) {
      if (l <= 1) {
        return -2;
      } else if (l == 2) {
        if (i == 1) {
          // l = 2, i = 1
          coefficients = {
            -5.333333333333e+00, 3.111111111111e+00, -1.333333333333e+00, 8.888888888889e-01,
            -1.333333333333e+00
          };
        }
      } else if (l == 3) {
        if (i == 1) {
          // l = 3, i = 1
          coefficients = {
            -5.429059829060e+00, 3.174928774929e+00, -5.082621082621e-01, 9.572649572650e-02,
            -2.564102564103e-02, 6.837606837607e-03, -4.558404558405e-03, 4.558404558405e-03,
            -6.837606837607e-03
          };
        } else {
          // l = 3, i = 3
          coefficients = {
            -1.723076923077e+00, 1.148717948718e+00, -1.148717948718e+00, 1.723076923077e+00,
            -4.615384615385e-01, 1.230769230769e-01, -8.205128205128e-02, 8.205128205128e-02,
            -1.230769230769e-01
          };
        }
      } else if (l == 4) {
        if (i == 1) {
          // l = 4, i = 1
          coefficients = {
            -5.429062359633e+00, 3.174930461977e+00, -5.082637953107e-01, 9.572902629932e-02,
            -2.565051528911e-02, 6.873034857137e-03, -1.841624139434e-03, 4.934617005997e-04,
            -1.322226629644e-04, 3.542895125808e-05, -9.493142067869e-06, 2.543617013400e-06,
            -6.813259857322e-07, 1.816869295286e-07, -1.211246196857e-07, 1.211246196857e-07,
            -1.816869295286e-07
          };
        } else if (i == 3) {
          // l = 4, i = 3
          coefficients = {
            -1.723122473388e+00, 1.148748315592e+00, -1.148748315592e+00, 1.723122473388e+00,
            -4.617092752041e-01, 1.237146274285e-01, -3.314923450982e-02, 8.882310610794e-03,
            -2.380007933360e-03, 6.377211226454e-04, -1.708765572216e-04, 4.578510624120e-05,
            -1.226386774318e-05, 3.270364731515e-06, -2.180243154343e-06, 2.180243154343e-06,
            -3.270364731515e-06
          };
        } else if (i == 5) {
          // l = 4, i = 5
          coefficients = {
            -1.237146274285e-01, 8.247641828564e-02, -8.247641828564e-02, 1.237146274285e-01,
            -4.639298528568e-01, 1.732004783999e+00, -4.640892831374e-01, 1.243523485511e-01,
            -3.332011106704e-02, 8.928095717035e-03, -2.392271801103e-03, 6.409914873769e-04,
            -1.716941484045e-04, 4.578510624120e-05, -3.052340416080e-05, 3.052340416080e-05,
            -4.578510624120e-05
          };
        } else {
          // l = 4, i = 7
          coefficients = {
            -8.882310610794e-03, 5.921540407196e-03, -5.921540407196e-03, 8.882310610794e-03,
            -3.330866479048e-02, 1.243523485511e-01, -4.641007294140e-01, 1.732050569105e+00,
            -4.641015470052e-01, 1.243556189158e-01, -3.332092865822e-02, 8.928095717035e-03,
            -2.391454209920e-03, 6.377211226454e-04, -4.251474150969e-04, 4.251474150969e-04,
            -6.377211226454e-04
          };
        }
      } else if (l == 5) {
        if (i == 1) {
          // l = 5, i = 1
          coefficients = {
            -5.429062359633e+00, 3.174930461977e+00, -5.082637953107e-01, 9.572902629932e-02,
            -2.565051528912e-02, 6.873034857162e-03, -1.841624139528e-03, 4.934617009481e-04,
            -1.322226642647e-04, 3.542895611082e-05, -9.493160178573e-06, 2.543684603468e-06,
            -6.815782352987e-07, 1.826283377269e-07, -4.893511560897e-08, 1.311212470895e-08,
            -3.513383226818e-09, 9.414081983270e-10, -2.522495664898e-10
          };
        } else if (i == 3) {
          // l = 5, i = 3
          coefficients = {
            -1.723122473388e+00, 1.148748315592e+00, -1.148748315592e+00, 1.723122473388e+00,
            -4.617092752042e-01, 1.237146274289e-01, -3.314923451150e-02, 8.882310617065e-03,
            -2.380007956765e-03, 6.377212099948e-04, -1.708768832143e-04, 4.578632286242e-05,
            -1.226840823538e-05, 3.287310079085e-06, -8.808320809614e-07, 2.360182447610e-07,
            -6.324089808273e-08, 1.694534756989e-08, -4.540492196816e-09, 1.216621217377e-09,
            -3.259926726905e-10
          };
        } else if (i == 5) {
          // l = 5, i = 5
          coefficients = {
            -1.237146274289e-01, 8.247641828594e-02, -8.247641828594e-02, 1.237146274289e-01,
            -4.639298528584e-01, 1.732004784005e+00, -4.640892831609e-01, 1.243523486389e-01,
            -3.332011139471e-02, 8.928096939928e-03, -2.392276365000e-03, 6.410085200739e-04,
            -1.717577152953e-04, 4.602234110718e-05, -1.233164913346e-05, 3.304255426654e-06,
            -8.853725731582e-07, 2.372348659784e-07, -6.356689075542e-08, 1.703269704327e-08,
            -4.563897417668e-09, 1.222892627398e-09, -3.276730919259e-10
          };
        } else if (i == 7) {
          // l = 5, i = 7
          coefficients = {
            -8.882310617065e-03, 5.921540411377e-03, -5.921540411377e-03, 8.882310617065e-03,
            -3.330866481399e-02, 1.243523486389e-01, -4.641007297417e-01, 1.732050570328e+00,
            -4.641015515692e-01, 1.243556359490e-01, -3.332099222679e-02, 8.928332958172e-03,
            -2.392339605898e-03, 6.410254654215e-04, -1.717622557875e-04, 4.602355772840e-05,
            -1.233197512613e-05, 3.304342776128e-06, -8.853959783791e-07, 2.372411373884e-07,
            -6.356857117465e-08, 1.703314731019e-08, -4.564018066111e-09, 1.222924954254e-09,
            -3.276817509052e-10
          };
        } else if (i == 9) {
          // l = 5, i = 9
          coefficients = {
            -6.377212099948e-04, 4.251474733299e-04, -4.251474733299e-04, 6.377212099948e-04,
            -2.391454537481e-03, 8.928096939928e-03, -3.332093322223e-02, 1.243556359490e-01,
            -4.641016105737e-01, 1.732050806346e+00, -4.641016148101e-01, 1.243556528943e-01,
            -3.332099676728e-02, 8.928334174794e-03, -2.392339931891e-03, 6.410255527710e-04,
            -1.717622791927e-04, 4.602356399981e-05, -1.233197680655e-05, 3.304343226395e-06,
            -8.853960990275e-07, 2.372411697153e-07, -6.356857983363e-08, 1.703314961925e-08,
            -4.564018643377e-09, 1.222924954254e-09, -3.276811736399e-10
          };
        } else if (i == 11) {
          // l = 5, i = 11
          coefficients = {
            -4.578632286242e-05, 3.052421524161e-05, -3.052421524161e-05, 4.578632286242e-05,
            -1.716987107341e-04, 6.410085200739e-04, -2.392335369562e-03, 8.928332958172e-03,
            -3.332099646313e-02, 1.243556528943e-01, -4.641016151142e-01, 1.732050807563e+00,
            -4.641016151361e-01, 1.243556529817e-01, -3.332099679069e-02, 8.928334181065e-03,
            -2.392339933572e-03, 6.410255532212e-04, -1.717622793133e-04, 4.602356403214e-05,
            -1.233197681521e-05, 3.304343228704e-06, -8.853960996048e-07, 2.372411697153e-07,
            -6.356857925637e-08, 1.703314731019e-08, -4.564009984397e-09, 1.222892627398e-09,
            -3.275605251960e-10
          };
        } else if (i == 13) {
          // l = 5, i = 13
          coefficients = {
            -3.287310079085e-06, 2.191540052723e-06, -2.191540052723e-06, 3.287310079085e-06,
            -1.232741279657e-05, 4.602234110718e-05, -1.717619516322e-04, 6.410254654215e-04,
            -2.392339910054e-03, 8.928334174794e-03, -3.332099678912e-02, 1.243556529817e-01,
            -4.641016151376e-01, 1.732050807569e+00, -4.641016151377e-01, 1.243556529821e-01,
            -3.332099679081e-02, 8.928334181097e-03, -2.392339933580e-03, 6.410255532235e-04,
            -1.717622793139e-04, 4.602356403214e-05, -1.233197681463e-05, 3.304343226395e-06,
            -8.853960909458e-07, 2.372411373884e-07, -6.356845860792e-08, 1.703269704327e-08,
            -4.562329565162e-09, 1.216621217377e-09, -8.110808115844e-10, 8.110808115844e-10,
            -1.216621217377e-09
          };
        } else {
          // l = 5, i = 15
          coefficients = {
            -2.360182447610e-07, 1.573454965074e-07, -1.573454965074e-07, 2.360182447610e-07,
            -8.850684178539e-07, 3.304255426654e-06, -1.233195328876e-05, 4.602355772840e-05,
            -1.717622776248e-04, 6.410255527710e-04, -2.392339933459e-03, 8.928334181065e-03,
            -3.332099679080e-02, 1.243556529821e-01, -4.641016151378e-01, 1.732050807569e+00,
            -4.641016151378e-01, 1.243556529821e-01, -3.332099679081e-02, 8.928334181097e-03,
            -2.392339933580e-03, 6.410255532212e-04, -1.717622793053e-04, 4.602356399981e-05,
            -1.233197669398e-05, 3.304342776128e-06, -8.853944105266e-07, 2.372348659784e-07,
            -6.354505338707e-08, 1.694534756989e-08, -1.129689837992e-08, 1.129689837992e-08,
            -1.694534756989e-08
          };
        }
      } else {
        if (i == 1) {
          // l >= 6, i = 1
          coefficients = {
            -5.429062359633e+00, 3.174930461977e+00, -5.082637953107e-01, 9.572902629932e-02,
            -2.565051528912e-02, 6.873034857162e-03, -1.841624139528e-03, 4.934617009481e-04,
            -1.322226642647e-04, 3.542895611082e-05, -9.493160178573e-06, 2.543684603468e-06,
            -6.815782352987e-07, 1.826283377269e-07, -4.893511560897e-08, 1.311212470895e-08,
            -3.513383226818e-09, 9.414081983270e-10, -2.522495664898e-10
          };
        } else if (i == 3) {
          // l >= 6, i = 3
          coefficients = {
            -1.723122473388e+00, 1.148748315592e+00, -1.148748315592e+00, 1.723122473388e+00,
            -4.617092752042e-01, 1.237146274289e-01, -3.314923451150e-02, 8.882310617065e-03,
            -2.380007956765e-03, 6.377212099948e-04, -1.708768832143e-04, 4.578632286242e-05,
            -1.226840823538e-05, 3.287310079085e-06, -8.808320809614e-07, 2.360182447610e-07,
            -6.324089808273e-08, 1.694534756989e-08, -4.540492196816e-09, 1.216621217377e-09,
            -3.259926726906e-10
          };
        } else if (i == 5) {
          // l >= 6, i = 5
          coefficients = {
            -1.237146274289e-01, 8.247641828594e-02, -8.247641828594e-02, 1.237146274289e-01,
            -4.639298528584e-01, 1.732004784005e+00, -4.640892831609e-01, 1.243523486389e-01,
            -3.332011139471e-02, 8.928096939928e-03, -2.392276365000e-03, 6.410085200739e-04,
            -1.717577152953e-04, 4.602234110718e-05, -1.233164913346e-05, 3.304255426654e-06,
            -8.853725731582e-07, 2.372348659784e-07, -6.356689075542e-08, 1.703269704327e-08,
            -4.563897417669e-09, 1.222892627403e-09, -3.276730919426e-10
          };
        } else if (i == 7) {
          // l >= 6, i = 7
          coefficients = {
            -8.882310617065e-03, 5.921540411377e-03, -5.921540411377e-03, 8.882310617065e-03,
            -3.330866481399e-02, 1.243523486389e-01, -4.641007297417e-01, 1.732050570328e+00,
            -4.641015515692e-01, 1.243556359490e-01, -3.332099222679e-02, 8.928332958172e-03,
            -2.392339605898e-03, 6.410254654215e-04, -1.717622557875e-04, 4.602355772840e-05,
            -1.233197512613e-05, 3.304342776128e-06, -8.853959783791e-07, 2.372411373884e-07,
            -6.356857117467e-08, 1.703314731025e-08, -4.564018066343e-09, 1.222924955118e-09,
            -3.276817541276e-10
          };
        } else if (i == 9) {
          // l >= 6, i = 9
          coefficients = {
            -6.377212099948e-04, 4.251474733299e-04, -4.251474733299e-04, 6.377212099948e-04,
            -2.391454537481e-03, 8.928096939928e-03, -3.332093322223e-02, 1.243556359490e-01,
            -4.641016105737e-01, 1.732050806346e+00, -4.641016148101e-01, 1.243556528943e-01,
            -3.332099676728e-02, 8.928334174794e-03, -2.392339931891e-03, 6.410255527710e-04,
            -1.717622791927e-04, 4.602356399981e-05, -1.233197680655e-05, 3.304343226395e-06,
            -8.853960990277e-07, 2.372411697161e-07, -6.356857983686e-08, 1.703314963128e-08,
            -4.564018688260e-09, 1.222925121760e-09, -3.276817987793e-10
          };
        } else if (i == 11) {
          // l >= 6, i = 11
          coefficients = {
            -4.578632286242e-05, 3.052421524161e-05, -3.052421524161e-05, 4.578632286242e-05,
            -1.716987107341e-04, 6.410085200739e-04, -2.392335369562e-03, 8.928332958172e-03,
            -3.332099646313e-02, 1.243556528943e-01, -4.641016151142e-01, 1.732050807563e+00,
            -4.641016151361e-01, 1.243556529817e-01, -3.332099679069e-02, 8.928334181065e-03,
            -2.392339933572e-03, 6.410255532212e-04, -1.717622793133e-04, 4.602356403214e-05,
            -1.233197681521e-05, 3.304343228716e-06, -8.853960996496e-07, 2.372411698828e-07,
            -6.356857988151e-08, 1.703314964324e-08, -4.564018691466e-09, 1.222925122619e-09,
            -3.276817990094e-10
          };
        } else if (i == 13) {
          // l >= 6, i = 13
          coefficients = {
            -3.287310079085e-06, 2.191540052723e-06, -2.191540052723e-06, 3.287310079085e-06,
            -1.232741279657e-05, 4.602234110718e-05, -1.717619516322e-04, 6.410254654215e-04,
            -2.392339910054e-03, 8.928334174794e-03, -3.332099678912e-02, 1.243556529817e-01,
            -4.641016151376e-01, 1.732050807569e+00, -4.641016151377e-01, 1.243556529821e-01,
            -3.332099679081e-02, 8.928334181097e-03, -2.392339933580e-03, 6.410255532235e-04,
            -1.717622793140e-04, 4.602356403231e-05, -1.233197681526e-05, 3.304343228728e-06,
            -8.853960996529e-07, 2.372411698836e-07, -6.356857988174e-08, 1.703314964331e-08,
            -4.564018691482e-09, 1.222925122623e-09, -3.276817990106e-10
          };
        } else if (i == 15) {
          // l >= 6, i = 15
          coefficients = {
            -2.360182447610e-07, 1.573454965074e-07, -1.573454965074e-07, 2.360182447610e-07,
            -8.850684178539e-07, 3.304255426654e-06, -1.233195328876e-05, 4.602355772840e-05,
            -1.717622776248e-04, 6.410255527710e-04, -2.392339933459e-03, 8.928334181065e-03,
            -3.332099679080e-02, 1.243556529821e-01, -4.641016151378e-01, 1.732050807569e+00,
            -4.641016151378e-01, 1.243556529821e-01, -3.332099679081e-02, 8.928334181097e-03,
            -2.392339933580e-03, 6.410255532236e-04, -1.717622793140e-04, 4.602356403231e-05,
            -1.233197681526e-05, 3.304343228728e-06, -8.853960996529e-07, 2.372411698837e-07,
            -6.356857988174e-08, 1.703314964331e-08, -4.564018691482e-09, 1.222925122623e-09,
            -3.276817990106e-10
          };
        } else if (i == 17) {
          // l >= 6, i = 17
          coefficients = {
            -1.694534756989e-08, 1.129689837992e-08, -1.129689837992e-08, 1.694534756989e-08,
            -6.354505338707e-08, 2.372348659784e-07, -8.853944105266e-07, 3.304342776128e-06,
            -1.233197669398e-05, 4.602356399981e-05, -1.717622793053e-04, 6.410255532212e-04,
            -2.392339933580e-03, 8.928334181097e-03, -3.332099679081e-02, 1.243556529821e-01,
            -4.641016151378e-01, 1.732050807569e+00, -4.641016151378e-01, 1.243556529821e-01,
            -3.332099679081e-02, 8.928334181097e-03, -2.392339933580e-03, 6.410255532236e-04,
            -1.717622793140e-04, 4.602356403231e-05, -1.233197681526e-05, 3.304343228728e-06,
            -8.853960996529e-07, 2.372411698837e-07, -6.356857988174e-08, 1.703314964331e-08,
            -4.564018691482e-09, 1.222925122623e-09, -3.276817990106e-10
          };
        } else if (i == 19) {
          // l >= 6, i = 19
          coefficients = {
            -1.216621217377e-09, 8.110808115844e-10, -8.110808115844e-10, 1.216621217377e-09,
            -4.562329565162e-09, 1.703269704327e-08, -6.356845860793e-08, 2.372411373884e-07,
            -8.853960909458e-07, 3.304343226395e-06, -1.233197681463e-05, 4.602356403214e-05,
            -1.717622793139e-04, 6.410255532235e-04, -2.392339933580e-03, 8.928334181097e-03,
            -3.332099679081e-02, 1.243556529821e-01, -4.641016151378e-01, 1.732050807569e+00,
            -4.641016151378e-01, 1.243556529821e-01, -3.332099679081e-02, 8.928334181097e-03,
            -2.392339933580e-03, 6.410255532236e-04, -1.717622793140e-04, 4.602356403231e-05,
            -1.233197681526e-05, 3.304343228728e-06, -8.853960996529e-07, 2.372411698837e-07,
            -6.356857988174e-08, 1.703314964331e-08, -4.564018691482e-09, 1.222925122623e-09,
            -3.276817990106e-10
          };
        } else {
          // l >= 6, i >= 21
          return -1;
        }
      }

    } else if (p == 5) {
      if (l <= 2) {
        return -2;
      } else if (l == 3) {
        if (i == 1) {
          // l = 3, i = 1
          coefficients = {
            -6.131015472313e+01, 1.541879581141e+01, -2.644062098054e+00, 5.490947757454e-01,
            -3.237133550489e-01, 2.411332372839e-01, -3.780877390796e-01, 7.933214524346e-01,
            -2.325154723127e+00
          };
        } else {
          // l = 3, i = 3
          coefficients = {
            -1.023713382193e+02, 3.345522135221e+01, -1.431708590161e+01, 6.821590307358e+00,
            -4.165450597177e+00, 3.143013384281e+00, -4.958701286227e+00, 1.043133673682e+01,
            -3.060633821933e+01
          };
        }
      } else if (l == 4) {
        if (i == 1) {
          // l = 4, i = 1
          coefficients = {
            -6.139731997446e+01, 1.544853655754e+01, -2.658237053281e+00, 5.581364648356e-01,
            -1.371903641096e-01, 3.757812092632e-02, -1.618052109154e-02, 6.966901055105e-03,
            -2.999668233426e-03, 1.291331885794e-03, -5.554319657175e-04, 2.377996602185e-04,
            -2.340589798537e-04, 2.846599904397e-04, -4.462692424009e-04, 9.363246383758e-04,
            -2.744212240634e-03
          };
        } else if (i == 3) {
          // l = 4, i = 3
          coefficients = {
            -1.035223550267e+02, 3.384794779068e+01, -1.450426613173e+01, 6.940985778710e+00,
            -1.822056802106e+00, 5.027524607237e-01, -2.166544743070e-01, 9.329329191947e-02,
            -4.016868030233e-02, 1.729229243472e-02, -7.437818948254e-03, 3.184387904186e-03,
            -3.134296255912e-03, 3.811897082278e-03, -5.976015176892e-03, 1.253837306705e-02,
            -3.674789217157e-02
          };
        } else if (i == 5) {
          // l = 4, i = 5
          coefficients = {
            -3.492548470351e+01, 1.190502774011e+01, -5.661088066918e+00, 3.591040551313e+00,
            -2.909730354114e+00, 2.820929597855e+00, -1.312581836866e+00, 5.693833129125e-01,
            -2.453355075552e-01, 1.056227048590e-01, -4.543112654943e-02, 1.945065311326e-02,
            -1.914468769146e-02, 2.328356167737e-02, -3.650227582456e-02, 7.658600916746e-02,
            -2.244608925235e-01
          };
        } else {
          // l = 4, i = 7
          coefficients = {
            -6.574530016086e+00, 2.243206822767e+00, -1.069128645048e+00, 6.819237457353e-01,
            -5.606255330270e-01, 5.693340322019e-01, -1.320001774204e+00, 2.841406322927e+00,
            -1.321352192902e+00, 5.730517994118e-01, -2.466646750328e-01, 1.056134822090e-01,
            -1.039526007927e-01, 1.264262048780e-01, -1.982019226991e-01, 4.158507200515e-01,
            -1.218789614961e+00
          };
        }
      } else if (l == 5) {
        if (i == 1) {
          // l = 5, i = 1
          coefficients = {
            -6.139732009599e+01, 1.544853659900e+01, -2.658237073044e+00, 5.581364774418e-01,
            -1.371903744749e-01, 3.757813145727e-02, -1.618054568882e-02, 6.966958241690e-03,
            -2.999801073625e-03, 1.291640414816e-03, -5.561485210718e-04, 2.394638425485e-04,
            -1.031072271253e-04, 4.439543010807e-05, -1.911557772841e-05, 8.230696515348e-06,
            -3.543935008792e-06, 1.525931046096e-06, -6.570282888610e-07, 2.829001812956e-07,
            -1.218098385646e-07, 5.244830146343e-08, -2.258291760596e-08, 9.723582554063e-09,
            -4.186583896630e-09, 1.802289035802e-09, -7.752065529536e-10, 3.318927721701e-10,
            -3.266719708624e-10, 3.972949047304e-10, -6.228500741169e-10, 1.306811706924e-09,
            -3.830048399201e-09
          };
        } else if (i == 3) {
          // l = 5, i = 3
          coefficients = {
            -1.035223566540e+02, 3.384794834595e+01, -1.450426639638e+01, 6.940985947520e+00,
            -1.822056940908e+00, 5.027526017442e-01, -2.166548036906e-01, 9.329405770807e-02,
            -4.017045917251e-02, 1.729642396328e-02, -7.447414379142e-03, 3.206673058342e-03,
            -1.380714366297e-03, 5.945015675644e-04, -2.559777188072e-04, 1.102176951243e-04,
            -4.745702233234e-05, 2.043382385753e-05, -8.798300787147e-06, 3.788331385383e-06,
            -1.631162031674e-06, 7.023379965118e-07, -3.024090516606e-07, 1.302090115292e-07,
            -5.606276779503e-08, 2.413454840712e-08, -1.038083221177e-08, 4.444393777466e-09,
            -4.374481749272e-09, 5.320197215677e-09, -8.340618494339e-09, 1.749958512382e-08,
            -5.128838197199e-08
          };
        } else if (i == 5) {
          // l = 5, i = 5
          coefficients = {
            -3.492549464376e+01, 1.190503113172e+01, -5.661089683420e+00, 3.591041582424e+00,
            -2.909731201936e+00, 2.820930459226e+00, -1.312583848783e+00, 5.693879904487e-01,
            -2.453463731251e-01, 1.056479407715e-01, -4.548973668623e-02, 1.958677372618e-02,
            -8.433582523329e-03, 3.631292749325e-03, -1.563545137125e-03, 6.732239901682e-04,
            -2.898736532303e-04, 1.248124488210e-04, -5.374116339476e-05, 2.313961989942e-05,
            -9.963349445335e-06, 4.289971659531e-06, -1.847153745992e-06, 7.953335460277e-07,
            -3.424386637061e-07, 1.474169547943e-07, -6.340747077906e-08, 2.714693415965e-08,
            -2.671990241553e-08, 3.249645525619e-08, -5.094558053442e-08, 1.068897377154e-07,
            -3.132760952928e-07
          };
        } else if (i == 7) {
          // l = 5, i = 7
          coefficients = {
            -6.574583990154e+00, 2.243225238708e+00, -1.069137422418e+00, 6.819293445216e-01,
            -5.606301365759e-01, 5.693387093237e-01, -1.320012698623e+00, 2.841431721267e+00,
            -1.321411191364e+00, 5.731888267412e-01, -2.469829195395e-01, 1.063525973123e-01,
            -4.579314442088e-02, 1.971741361683e-02, -8.489832839578e-03, 3.655512748736e-03,
            -1.573973671702e-03, 6.777142598854e-04, -2.918070522595e-04, 1.256449218202e-04,
            -5.409960351844e-05, 2.329395020815e-05, -1.002978825987e-05, 4.318550678273e-06,
            -1.859394377115e-06, 8.004535874233e-07, -3.442937586477e-07, 1.474040816129e-07,
            -1.450853585597e-07, 1.764512380862e-07, -2.766274256515e-07, 5.803964281614e-07,
            -1.701045681489e-06
          };
        } else if (i == 9) {
          // l = 5, i = 9
          coefficients = {
            -1.219080775980e+00, 4.159500641297e-01, -1.982492718819e-01, 1.264564073133e-01,
            -1.039774344590e-01, 1.056387127616e-01, -2.467236063845e-01, 5.731888097721e-01,
            -1.321670457818e+00, 2.842145511544e+00, -1.321718531862e+00, 5.733211599830e-01,
            -2.470398989710e-01, 1.063771312508e-01, -4.580370812987e-02, 1.972196208932e-02,
            -8.491791299286e-03, 3.656356012245e-03, -1.574336757953e-03, 6.778705907021e-04,
            -2.918743524434e-04, 1.256738717233e-04, -5.411200384302e-05, 2.329913900915e-05,
            -1.003167295991e-05, 4.318550549280e-06, -1.857509322068e-06, 7.952640697940e-07,
            -7.827542592658e-07, 9.519772328227e-07, -1.492440710821e-06, 3.131313736384e-06,
            -9.177361283106e-06
          };
        } else if (i == 11) {
          // l = 5, i = 11
          coefficients = {
            -2.260119818309e-01, 7.711524051240e-02, -3.675451704698e-02, 2.344445778478e-02,
            -1.927698299121e-02, 1.958506272809e-02, -4.574506895173e-02, 1.063525941348e-01,
            -2.470309862637e-01, 5.733211599771e-01, -1.321727444554e+00, 2.842170048628e+00,
            -1.321729096926e+00, 5.733257090385e-01, -2.470418576817e-01, 1.063779746224e-01,
            -4.580407126267e-02, 1.972211844018e-02, -8.491858608099e-03, 3.656384965864e-03,
            -1.574349159878e-03, 6.778757801920e-04, -2.918762374400e-04, 1.256738717220e-04,
            -5.411011884283e-05, 2.329394951213e-05, -1.001927101994e-05, 4.289596909704e-06,
            -4.222119895941e-06, 5.134896383641e-06, -8.050117318528e-06, 1.689007995845e-05,
            -4.950202340896e-05
          };
        } else if (i == 13) {
          // l = 5, i = 13
          coefficients = {
            -4.190152128482e-02, 1.429679023477e-02, -6.814108574310e-03, 4.346488391357e-03,
            -3.573858894303e-03, 3.630975538298e-03, -8.480919881626e-03, 1.971741302768e-02,
            -4.580205575740e-02, 1.063771312497e-01, -2.470415513404e-01, 5.733257090385e-01,
            -1.321729403267e+00, 2.842170892001e+00, -1.321729460059e+00, 5.733258653896e-01,
            -2.470419249906e-01, 1.063780035760e-01, -4.580408366461e-02, 1.972212362967e-02,
            -8.491860493099e-03, 3.656384965864e-03, -1.574347274878e-03, 6.778705906952e-04,
            -2.918638354995e-04, 1.256449180659e-04, -5.404280994623e-05, 2.313759854142e-05,
            -2.277363519286e-05, 2.769704789923e-05, -4.342141852678e-05, 9.110317301075e-05,
            -2.670082920923e-04
          };
        } else {
          // l = 5, i = 15
          coefficients = {
            -7.768337967213e-03, 2.650555277842e-03, -1.263302541987e-03, 8.058177785009e-04,
            -6.625760328769e-04, 6.731651807881e-04, -1.572321252784e-03, 3.655512639510e-03,
            -8.491484957891e-03, 1.972196208912e-02, -4.580401447071e-02, 1.063779746224e-01,
            -2.470419144737e-01, 5.733258653896e-01, -1.321729470576e+00, 2.842170920954e+00,
            -1.321729472461e+00, 5.733258705791e-01, -2.470419268756e-01, 1.063780035760e-01,
            -4.580408177961e-02, 1.972211844018e-02, -8.491848091158e-03, 3.656356012208e-03,
            -1.574279965977e-03, 6.777142396354e-04, -2.915007022530e-04, 1.248015458483e-04,
            -1.228383693998e-04, 1.493946913752e-04, -2.342101383326e-04, 4.914000389053e-04,
            -1.440212023205e-03
          };
        }
      } else {
        if (i == 1) {
          // l >= 6, i = 1
          coefficients = {
            -6.139732009599e+01, 1.544853659900e+01, -2.658237073044e+00, 5.581364774418e-01,
            -1.371903744749e-01, 3.757813145727e-02, -1.618054568882e-02, 6.966958241690e-03,
            -2.999801073625e-03, 1.291640414816e-03, -5.561485210718e-04, 2.394638425485e-04,
            -1.031072271253e-04, 4.439543010809e-05, -1.911557772845e-05, 8.230696515442e-06,
            -3.543935009011e-06, 1.525931046605e-06, -6.570282900425e-07, 2.829001840395e-07,
            -1.218098449375e-07, 5.244831626415e-08, -2.258295198024e-08, 9.723662387435e-09,
            -4.186769307553e-09, 1.802719647827e-09, -7.762066380871e-10, 3.342154426157e-10,
            -1.439049302104e-10
          };
        } else if (i == 3) {
          // l >= 6, i = 3
          coefficients = {
            -1.035223566540e+02, 3.384794834595e+01, -1.450426639638e+01, 6.940985947520e+00,
            -1.822056940908e+00, 5.027526017442e-01, -2.166548036906e-01, 9.329405770807e-02,
            -4.017045917251e-02, 1.729642396328e-02, -7.447414379142e-03, 3.206673058342e-03,
            -1.380714366297e-03, 5.945015675646e-04, -2.559777188078e-04, 1.102176951256e-04,
            -4.745702233527e-05, 2.043382386434e-05, -8.798300802969e-06, 3.788331422128e-06,
            -1.631162117013e-06, 7.023381947090e-07, -3.024095119684e-07, 1.302100805821e-07,
            -5.606525064257e-08, 2.414031475567e-08, -1.039422440503e-08, 4.475496781029e-09,
            -1.927038579936e-09, 8.297353054311e-10, -3.572635671371e-10, 1.538288844262e-10
          };
        } else if (i == 5) {
          // l >= 6, i = 5
          coefficients = {
            -3.492549464376e+01, 1.190503113172e+01, -5.661089683420e+00, 3.591041582424e+00,
            -2.909731201936e+00, 2.820930459226e+00, -1.312583848783e+00, 5.693879904487e-01,
            -2.453463731251e-01, 1.056479407715e-01, -4.548973668623e-02, 1.958677372618e-02,
            -8.433582523330e-03, 3.631292749327e-03, -1.563545137129e-03, 6.732239901759e-04,
            -2.898736532482e-04, 1.248124488626e-04, -5.374116349140e-05, 2.313962012387e-05,
            -9.963349966595e-06, 4.289972870145e-06, -1.847156557612e-06, 7.953400759419e-07,
            -3.424538292612e-07, 1.474521763999e-07, -6.348927203402e-08, 2.733691534317e-08,
            -1.177060181253e-08, 5.068130961005e-09, -2.182212247683e-09, 9.396067959919e-10,
            -4.045715223217e-10, 1.741985236504e-10
          };
        } else if (i == 7) {
          // l >= 6, i = 7
          coefficients = {
            -6.574583990154e+00, 2.243225238708e+00, -1.069137422418e+00, 6.819293445216e-01,
            -5.606301365759e-01, 5.693387093237e-01, -1.320012698623e+00, 2.841431721267e+00,
            -1.321411191364e+00, 5.731888267412e-01, -2.469829195395e-01, 1.063525973123e-01,
            -4.579314442088e-02, 1.971741361684e-02, -8.489832839596e-03, 3.655512748778e-03,
            -1.573973671799e-03, 6.777142601113e-04, -2.918070527842e-04, 1.256449230389e-04,
            -5.409960634881e-05, 2.329395678161e-05, -1.002980352657e-05, 4.318586134799e-06,
            -1.859476723972e-06, 8.006448358487e-07, -3.447379280994e-07, 1.484356530499e-07,
            -6.391273283398e-08, 2.751924712410e-08, -1.184910938239e-08, 5.101934385147e-09,
            -2.196767168766e-09, 9.458737861893e-10, -4.072699338012e-10, 1.753603931098e-10
          };
        } else if (i == 9) {
          // l >= 6, i = 9
          coefficients = {
            -1.219080775980e+00, 4.159500641297e-01, -1.982492718819e-01, 1.264564073133e-01,
            -1.039774344590e-01, 1.056387127616e-01, -2.467236063845e-01, 5.731888097721e-01,
            -1.321670457818e+00, 2.842145511544e+00, -1.321718531862e+00, 5.733211599830e-01,
            -2.470398989710e-01, 1.063771312508e-01, -4.580370812997e-02, 1.972196208955e-02,
            -8.491791299811e-03, 3.656356013464e-03, -1.574336760784e-03, 6.778705972771e-04,
            -2.918743677136e-04, 1.256739071880e-04, -5.411208620888e-05, 2.329933030169e-05,
            -1.003211723185e-05, 4.319582359250e-06, -1.859905673661e-06, 8.008295310099e-07,
            -3.448174532825e-07, 1.484698946332e-07, -6.392747641560e-08, 2.752559534687e-08,
            -1.185184277061e-08, 5.103111314731e-09, -2.197273925630e-09, 9.460919832019e-10,
            -4.073638840557e-10, 1.754008457733e-10
          };
        } else if (i == 11) {
          // l >= 6, i = 11
          coefficients = {
            -2.260119818309e-01, 7.711524051240e-02, -3.675451704698e-02, 2.344445778478e-02,
            -1.927698299121e-02, 1.958506272809e-02, -4.574506895173e-02, 1.063525941348e-01,
            -2.470309862637e-01, 5.733211599771e-01, -1.321727444554e+00, 2.842170048628e+00,
            -1.321729096926e+00, 5.733257090387e-01, -2.470418576823e-01, 1.063779746236e-01,
            -4.580407126550e-02, 1.972211844675e-02, -8.491858623370e-03, 3.656385001329e-03,
            -1.574349242244e-03, 6.778759714860e-04, -2.918766817155e-04, 1.256749035401e-04,
            -5.411251521355e-05, 2.329951502053e-05, -1.003219676722e-05, 4.319616605223e-06,
            -1.859920419133e-06, 8.008358800464e-07, -3.448201870211e-07, 1.484710717137e-07,
            -6.392798323743e-08, 2.752581357186e-08, -1.185193673291e-08, 5.103151772580e-09,
            -2.197291345783e-09, 9.460994838901e-10, -4.073671136671e-10, 1.754022363643e-10
          };
        } else if (i == 13) {
          // l >= 6, i = 13
          coefficients = {
            -4.190152128484e-02, 1.429679023478e-02, -6.814108574313e-03, 4.346488391359e-03,
            -3.573858894304e-03, 3.630975538300e-03, -8.480919881629e-03, 1.971741302769e-02,
            -4.580205575742e-02, 1.063771312497e-01, -2.470415513405e-01, 5.733257090387e-01,
            -1.321729403267e+00, 2.842170892002e+00, -1.321729460062e+00, 5.733258653961e-01,
            -2.470419250059e-01, 1.063780036115e-01, -4.580408374698e-02, 1.972212382097e-02,
            -8.491860937374e-03, 3.656385997682e-03, -1.574349671249e-03, 6.778761562051e-04,
            -2.918767612510e-04, 1.256749377861e-04, -5.411252995904e-05, 2.329952136957e-05,
            -1.003219950097e-05, 4.319617782305e-06, -1.859920925955e-06, 8.008360982717e-07,
            -3.448202809835e-07, 1.484711121716e-07, -6.392800065760e-08, 2.752582107255e-08,
            -1.185193996253e-08, 5.103153163173e-09, -2.197291944538e-09, 9.460997416992e-10,
            -4.073672246733e-10, 1.754022841609e-10
          };
        } else if (i == 15) {
          // l >= 6, i = 15
          coefficients = {
            -7.768337967302e-03, 2.650555277873e-03, -1.263302542001e-03, 8.058177785101e-04,
            -6.625760328845e-04, 6.731651807958e-04, -1.572321252802e-03, 3.655512639552e-03,
            -8.491484957988e-03, 1.972196208934e-02, -4.580401447123e-02, 1.063779746236e-01,
            -2.470419144765e-01, 5.733258653961e-01, -1.321729470591e+00, 2.842170920990e+00,
            -1.321729472543e+00, 5.733258707704e-01, -2.470419273199e-01, 1.063780046078e-01,
            -4.580408417598e-02, 1.972212400569e-02, -8.491861016910e-03, 3.656386031928e-03,
            -1.574349685995e-03, 6.778761625542e-04, -2.918767639847e-04, 1.256749389632e-04,
            -5.411253046587e-05, 2.329952158780e-05, -1.003219959493e-05, 4.319617822763e-06,
            -1.859920943375e-06, 8.008361057724e-07, -3.448202842131e-07, 1.484711135622e-07,
            -6.392800125636e-08, 2.752582133036e-08, -1.185194007353e-08, 5.103153210970e-09,
            -2.197291965118e-09, 9.460997505605e-10, -4.073672284888e-10, 1.754022858037e-10
          };
        } else if (i == 17) {
          // l >= 6, i = 17
          coefficients = {
            -1.440212023685e-03, 4.914000390692e-04, -2.342101384106e-04, 1.493946914250e-04,
            -1.228383694407e-04, 1.248015458899e-04, -2.915007023502e-04, 6.777142398613e-04,
            -1.574279966502e-03, 3.656356013427e-03, -8.491848093989e-03, 1.972211844675e-02,
            -4.580408179488e-02, 1.063780036115e-01, -2.470419269580e-01, 5.733258707704e-01,
            -1.321729472905e+00, 2.842170921986e+00, -1.321729472972e+00, 5.733258709551e-01,
            -2.470419273994e-01, 1.063780046421e-01, -4.580408419073e-02, 1.972212401204e-02,
            -8.491861019644e-03, 3.656386033106e-03, -1.574349686502e-03, 6.778761627724e-04,
            -2.918767640787e-04, 1.256749390037e-04, -5.411253048329e-05, 2.329952159530e-05,
            -1.003219959816e-05, 4.319617824154e-06, -1.859920943974e-06, 8.008361060302e-07,
            -3.448202843241e-07, 1.484711136100e-07, -6.392800127694e-08, 2.752582133922e-08,
            -1.185194007735e-08, 5.103153212612e-09, -2.197291965825e-09, 9.460997508650e-10,
            -4.073672286199e-10, 1.754022858601e-10
          };
        } else if (i == 19) {
          // l >= 6, i = 19
          coefficients = {
            -2.670082946821e-04, 9.110317389440e-05, -4.342141894794e-05, 2.769704816788e-05,
            -2.277363541375e-05, 2.313759876584e-05, -5.404281047042e-05, 1.256449192846e-04,
            -2.918638383304e-04, 6.778705972701e-04, -1.574347290148e-03, 3.656385001329e-03,
            -8.491860575465e-03, 1.972212382097e-02, -4.580408410889e-02, 1.063780046078e-01,
            -2.470419273870e-01, 5.733258709551e-01, -1.321729472985e+00, 2.842170922020e+00,
            -1.321729472987e+00, 5.733258709614e-01, -2.470419274022e-01, 1.063780046433e-01,
            -4.580408419123e-02, 1.972212401226e-02, -8.491861019738e-03, 3.656386033146e-03,
            -1.574349686519e-03, 6.778761627799e-04, -2.918767640819e-04, 1.256749390051e-04,
            -5.411253048388e-05, 2.329952159556e-05, -1.003219959827e-05, 4.319617824201e-06,
            -1.859920943995e-06, 8.008361060390e-07, -3.448202843280e-07, 1.484711136116e-07,
            -6.392800127764e-08, 2.752582133953e-08, -1.185194007748e-08, 5.103153212669e-09,
            -2.197291965849e-09, 9.460997508751e-10, -4.073672286236e-10, 1.754022858601e-10
          };
        } else if (i == 21) {
          // l >= 6, i = 21
          coefficients = {
            -4.950203737825e-05, 1.689008472477e-05, -8.050119590242e-06, 5.134897832690e-06,
            -4.222121087408e-06, 4.289598120213e-06, -1.001927384734e-05, 2.329395608559e-05,
            -5.411013411251e-05, 1.256739071867e-04, -2.918763198064e-04, 6.778759714860e-04,
            -1.574349604153e-03, 3.656385997682e-03, -8.491861004471e-03, 1.972212400569e-02,
            -4.580408418842e-02, 1.063780046421e-01, -2.470419274017e-01, 5.733258709614e-01,
            -1.321729472987e+00, 2.842170922022e+00, -1.321729472987e+00, 5.733258709617e-01,
            -2.470419274023e-01, 1.063780046433e-01, -4.580408419125e-02, 1.972212401226e-02,
            -8.491861019741e-03, 3.656386033147e-03, -1.574349686520e-03, 6.778761627801e-04,
            -2.918767640820e-04, 1.256749390051e-04, -5.411253048390e-05, 2.329952159557e-05,
            -1.003219959827e-05, 4.319617824203e-06, -1.859920943995e-06, 8.008361060394e-07,
            -3.448202843281e-07, 1.484711136117e-07, -6.392800127767e-08, 2.752582133954e-08,
            -1.185194007748e-08, 5.103153212669e-09, -2.197291965845e-09, 9.460997508650e-10,
            -4.073672285994e-10, 1.754022858037e-10
          };
        } else if (i == 23) {
          // l >= 6, i = 23
          coefficients = {
            -9.177436631753e-06, 3.131339445326e-06, -1.492452964167e-06, 9.519850488162e-07,
            -7.827606858924e-07, 7.952705991296e-07, -1.857524572727e-06, 4.318586005761e-06,
            -1.003175532269e-05, 2.329933030145e-05, -5.411244811738e-05, 1.256749035401e-04,
            -2.918767488117e-04, 6.778761562051e-04, -1.574349683689e-03, 3.656386031928e-03,
            -8.491861019216e-03, 1.972212401204e-02, -4.580408419115e-02, 1.063780046433e-01,
            -2.470419274023e-01, 5.733258709617e-01, -1.321729472988e+00, 2.842170922022e+00,
            -1.321729472988e+00, 5.733258709617e-01, -2.470419274023e-01, 1.063780046433e-01,
            -4.580408419125e-02, 1.972212401226e-02, -8.491861019741e-03, 3.656386033147e-03,
            -1.574349686520e-03, 6.778761627802e-04, -2.918767640820e-04, 1.256749390051e-04,
            -5.411253048391e-05, 2.329952159557e-05, -1.003219959827e-05, 4.319617824203e-06,
            -1.859920943995e-06, 8.008361060394e-07, -3.448202843281e-07, 1.484711136117e-07,
            -6.392800127766e-08, 2.752582133953e-08, -1.185194007746e-08, 5.103153212612e-09,
            -2.197291965714e-09, 9.460997505605e-10, -4.073672278920e-10, 1.754022841609e-10
          };
        } else if (i == 25) {
          // l >= 6, i = 25
          coefficients = {
            -1.701452053100e-06, 5.805350820694e-07, -2.766935106096e-07, 1.764933914361e-07,
            -1.451200187522e-07, 1.474392957372e-07, -3.443760087664e-07, 8.006448119256e-07,
            -1.859838577466e-06, 4.319582359206e-06, -1.003218432792e-05, 2.329951502053e-05,
            -5.411252765286e-05, 1.256749377861e-04, -2.918767635572e-04, 6.778761625542e-04,
            -1.574349686422e-03, 3.656386033106e-03, -8.491861019723e-03, 1.972212401226e-02,
            -4.580408419125e-02, 1.063780046433e-01, -2.470419274023e-01, 5.733258709617e-01,
            -1.321729472988e+00, 2.842170922022e+00, -1.321729472988e+00, 5.733258709617e-01,
            -2.470419274023e-01, 1.063780046433e-01, -4.580408419125e-02, 1.972212401226e-02,
            -8.491861019741e-03, 3.656386033147e-03, -1.574349686520e-03, 6.778761627802e-04,
            -2.918767640820e-04, 1.256749390051e-04, -5.411253048391e-05, 2.329952159557e-05,
            -1.003219959827e-05, 4.319617824203e-06, -1.859920943995e-06, 8.008361060394e-07,
            -3.448202843281e-07, 1.484711136116e-07, -6.392800127753e-08, 2.752582133922e-08,
            -1.185194007675e-08, 5.103153210970e-09, -2.197291961899e-09, 9.460997416992e-10,
            -4.073672073120e-10, 1.754022363643e-10
          };
        } else if (i == 27) {
          // l >= 6, i = 27
          coefficients = {
            -3.154409237739e-07, 1.076283767371e-07, -5.129762923964e-08, 3.272101516654e-08,
            -2.690454467400e-08, 2.733452733106e-08, -6.384563475237e-08, 1.484356486147e-07,
            -3.448050139746e-07, 8.008295310016e-07, -1.859918112946e-06, 4.319616605223e-06,
            -1.003219907341e-05, 2.329952136957e-05, -5.411253038660e-05, 1.256749389632e-04,
            -2.918767640640e-04, 6.778761627724e-04, -1.574349686516e-03, 3.656386033146e-03,
            -8.491861019740e-03, 1.972212401226e-02, -4.580408419125e-02, 1.063780046433e-01,
            -2.470419274023e-01, 5.733258709617e-01, -1.321729472988e+00, 2.842170922022e+00,
            -1.321729472988e+00, 5.733258709617e-01, -2.470419274023e-01, 1.063780046433e-01,
            -4.580408419125e-02, 1.972212401226e-02, -8.491861019741e-03, 3.656386033147e-03,
            -1.574349686520e-03, 6.778761627802e-04, -2.918767640820e-04, 1.256749390051e-04,
            -5.411253048391e-05, 2.329952159557e-05, -1.003219959827e-05, 4.319617824203e-06,
            -1.859920943995e-06, 8.008361060390e-07, -3.448202843274e-07, 1.484711136100e-07,
            -6.392800127372e-08, 2.752582133036e-08, -1.185194005617e-08, 5.103153163173e-09,
            -2.197291850893e-09, 9.460994838901e-10, -4.073666085570e-10, 1.754008457715e-10
          };
        } else {
          // l >= 6, i >= 29
          return -1;
        }
      }

    } else {
      throw std::invalid_argument("Degree is unsupported.");
    }

    return 0;
  }

  /**
   * @param l     level of basis function
   * @param i     index of basis function
   * @param x     evaluation point
   * @return      value of fundamental not-a-knot spline basis function
   */
  inline double eval(LT l, IT i, double x) override {
    const IT hInv = static_cast<IT>(1) << l;

    if (i > hInv / 2) {
      i = hInv - i;
      x = 1.0 - x;
    }

    std::vector<double> coefficients;
    const int status = getCoefficients(l, i, coefficients);

    if (status == -1) {
      return fundamentalSplineBasis.eval(l, i, x);
    } else if (status == -2) {
      return notAKnotBsplineBasis.eval(l, i, x);
    } else {
      double y = 0;

      for (IT j = 0; j < coefficients.size(); j++) {
        y += coefficients[j] * notAKnotBsplineBasis.eval(l, j, x);
      }

      return y;
    }
  }

  /**
   * @param l     level of basis function
   * @param i     index of basis function
   * @param x     evaluation point
   * @return      value of derivative of fundamental not-a-knot spline basis
   *              function
   */
  inline double evalDx(LT l, IT i, double x) {
    const IT hInv = static_cast<IT>(1) << l;
    double innerDeriv = 1.0;

    if (i > hInv / 2) {
      i = hInv - i;
      x = 1.0 - x;
      innerDeriv *= -1.0;
    }

    std::vector<double> coefficients;
    const int status = getCoefficients(l, i, coefficients);

    if (status == -1) {
      return innerDeriv * fundamentalSplineBasis.evalDx(l, i, x);
    } else if (status == -2) {
      return innerDeriv * notAKnotBsplineBasisDeriv1.eval(l, i, x);
    } else {
      double y = 0;

      for (IT j = 0; j < coefficients.size(); j++) {
        y += coefficients[j] * notAKnotBsplineBasisDeriv1.eval(l, j, x);
      }

      return innerDeriv * y;
    }
  }

  /**
   * @param l     level of basis function
   * @param i     index of basis function
   * @param x     evaluation point
   * @return      value of 2nd derivative of fundamental not-a-knot spline basis
   *              function
   */
  inline double evalDxDx(LT l, IT i, double x) {
    const IT hInv = static_cast<IT>(1) << l;
    // double innerDeriv = 1.0;

    if (i > hInv / 2) {
      i = hInv - i;
      x = 1.0 - x;
    }

    std::vector<double> coefficients;
    const int status = getCoefficients(l, i, coefficients);

    if (status == -1) {
      return fundamentalSplineBasis.evalDxDx(l, i, x);
    } else if (status == -2) {
      return notAKnotBsplineBasisDeriv2.eval(l, i, x);
    } else {
      double y = 0;

      for (IT j = 0; j < coefficients.size(); j++) {
        y += coefficients[j] * notAKnotBsplineBasisDeriv2.eval(l, j, x);
      }

      return y;
    }
  }

  inline double getIntegral(LT level, IT index) override { return -1.0; }

  /**
   * @return      fundamental not-a-knot spline degree
   */
  inline size_t getDegree() const {
    return notAKnotBsplineBasis.getDegree();
  }

 protected:
  /// B-spline coefficients
  std::vector<double> coefficients;
  /// not-a-knot B-spline basis
  NotAKnotBsplineBasis<LT, IT> notAKnotBsplineBasis;
  /// 1st derivative of not-a-knot B-spline basis
  NotAKnotBsplineBasisDeriv1<LT, IT> notAKnotBsplineBasisDeriv1;
  /// 2nd derivative of not-a-knot B-spline basis
  NotAKnotBsplineBasisDeriv2<LT, IT> notAKnotBsplineBasisDeriv2;
  /// fundamental spline basis
  FundamentalSplineBasis<LT, IT> fundamentalSplineBasis;
};

// default type-def (unsigned int for level and index)
typedef FundamentalNotAKnotSplineBasis<unsigned int, unsigned int>
SFundamentalNotAKnotSplineBase;

}  // namespace base
}  // namespace sgpp

#endif /* FUNDAMENTAL_NOTAKNOT_SPLINE_BASE_HPP */
