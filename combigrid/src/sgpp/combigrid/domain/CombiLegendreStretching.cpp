/*
 * CombiLegendreStretching.cpp
 *
 *  Created on: 21 Aug 2014
 *      Author: kenny
 */

#include <sgpp/combigrid/domain/CombiLegendreStretching.hpp>


void combigrid::CombiLegendreStretching::get1DStretching(int level, double min, double max,
		std::vector<double>& stretching, std::vector<double>& jacobian) const {

	stretching.clear();
	jacobian.clear();

	TRANSFORMATION_TYPE type = FINITE;

	if (min == n_INF && max < p_INF)
		type = SEMI_INFINITE_NINF;
	if (min > n_INF && max == p_INF)
		type = SEMI_INFINITE_PINF;
	if (min == n_INF && max == p_INF)
		type = INFINITE;

	switch (level) {
	case 1: {
		int nr_pts = 3;
		double abscissas[3] = { -1.0, 0.0, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}

	case 2: {
		int nr_pts = 5;
		double abscissas[5] = { -1.0, -0.77459666924148337704E+00, 0.0E+00,
				0.77459666924148337704E+00, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}

	case 3: {
		int nr_pts = 9;
		double abscissas[9] = { -1.0, -0.96049126870802028342E+00,
				-0.77459666924148337704E+00, -0.43424374934680255800E+00,
				0.0E+00, 0.43424374934680255800E+00, 0.77459666924148337704E+00,
				0.96049126870802028342E+00, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}

	case 4: {
		int nr_pts = 17;
		double abscissas[17] = { -1.0, -0.99383196321275502221E+00,
				-0.96049126870802028342E+00, -0.88845923287225699889E+00,
				-0.77459666924148337704E+00, -0.62110294673722640294E+00,
				-0.43424374934680255800E+00, -0.22338668642896688163E+00,
				0.0E+00, 0.22338668642896688163E+00, 0.43424374934680255800E+00,
				0.62110294673722640294E+00, 0.77459666924148337704E+00,
				0.88845923287225699889E+00, 0.96049126870802028342E+00,
				0.99383196321275502221E+00, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}

	case 5: {
		int nr_pts = 33;
		double abscissas[33] = { -1.0, -0.99909812496766759766E+00,
				-0.99383196321275502221E+00, -0.98153114955374010687E+00,
				-0.96049126870802028342E+00, -0.92965485742974005667E+00,
				-0.88845923287225699889E+00, -0.83672593816886873550E+00,
				-0.77459666924148337704E+00, -0.70249620649152707861E+00,
				-0.62110294673722640294E+00, -0.53131974364437562397E+00,
				-0.43424374934680255800E+00, -0.33113539325797683309E+00,
				-0.22338668642896688163E+00, -0.11248894313318662575E+00,
				0.0E+00, 0.11248894313318662575E+00, 0.22338668642896688163E+00,
				0.33113539325797683309E+00, 0.43424374934680255800E+00,
				0.53131974364437562397E+00, 0.62110294673722640294E+00,
				0.70249620649152707861E+00, 0.77459666924148337704E+00,
				0.83672593816886873550E+00, 0.88845923287225699889E+00,
				0.92965485742974005667E+00, 0.96049126870802028342E+00,
				0.98153114955374010687E+00, 0.99383196321275502221E+00,
				0.99909812496766759766E+00, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}

	case 6: {
		int nr_pts = 65;
		double abscissas[65] = { -1.0, -0.99987288812035761194E+00,
				-0.99909812496766759766E+00, -0.99720625937222195908E+00,
				-0.99383196321275502221E+00, -0.98868475754742947994E+00,
				-0.98153114955374010687E+00, -0.97218287474858179658E+00,
				-0.96049126870802028342E+00, -0.94634285837340290515E+00,
				-0.92965485742974005667E+00, -0.91037115695700429250E+00,
				-0.88845923287225699889E+00, -0.86390793819369047715E+00,
				-0.83672593816886873550E+00, -0.80694053195021761186E+00,
				-0.77459666924148337704E+00, -0.73975604435269475868E+00,
				-0.70249620649152707861E+00, -0.66290966002478059546E+00,
				-0.62110294673722640294E+00, -0.57719571005204581484E+00,
				-0.53131974364437562397E+00, -0.48361802694584102756E+00,
				-0.43424374934680255800E+00, -0.38335932419873034692E+00,
				-0.33113539325797683309E+00, -0.27774982202182431507E+00,
				-0.22338668642896688163E+00, -0.16823525155220746498E+00,
				-0.11248894313318662575E+00, -0.056344313046592789972E+00,
				0.0E+00, 0.056344313046592789972E+00,
				0.11248894313318662575E+00, 0.16823525155220746498E+00,
				0.22338668642896688163E+00, 0.27774982202182431507E+00,
				0.33113539325797683309E+00, 0.38335932419873034692E+00,
				0.43424374934680255800E+00, 0.48361802694584102756E+00,
				0.53131974364437562397E+00, 0.57719571005204581484E+00,
				0.62110294673722640294E+00, 0.66290966002478059546E+00,
				0.70249620649152707861E+00, 0.73975604435269475868E+00,
				0.77459666924148337704E+00, 0.80694053195021761186E+00,
				0.83672593816886873550E+00, 0.86390793819369047715E+00,
				0.88845923287225699889E+00, 0.91037115695700429250E+00,
				0.92965485742974005667E+00, 0.94634285837340290515E+00,
				0.96049126870802028342E+00, 0.97218287474858179658E+00,
				0.98153114955374010687E+00, 0.98868475754742947994E+00,
				0.99383196321275502221E+00, 0.99720625937222195908E+00,
				0.99909812496766759766E+00, 0.99987288812035761194E+00, +1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));
		break;
	}

	case 7: {
		int nr_pts = 129;
		double abscissas[129] = { -1.0, -0.99998243035489159858E+00,
				-0.99987288812035761194E+00, -0.99959879967191068325E+00,
				-0.99909812496766759766E+00, -0.99831663531840739253E+00,
				-0.99720625937222195908E+00, -0.99572410469840718851E+00,
				-0.99383196321275502221E+00, -0.99149572117810613240E+00,
				-0.98868475754742947994E+00, -0.98537149959852037111E+00,
				-0.98153114955374010687E+00, -0.97714151463970571416E+00,
				-0.97218287474858179658E+00, -0.96663785155841656709E+00,
				-0.96049126870802028342E+00, -0.95373000642576113641E+00,
				-0.94634285837340290515E+00, -0.93832039777959288365E+00,
				-0.92965485742974005667E+00, -0.92034002547001242073E+00,
				-0.91037115695700429250E+00, -0.89974489977694003664E+00,
				-0.88845923287225699889E+00, -0.87651341448470526974E+00,
				-0.86390793819369047715E+00, -0.85064449476835027976E+00,
				-0.83672593816886873550E+00, -0.82215625436498040737E+00,
				-0.80694053195021761186E+00, -0.79108493379984836143E+00,
				-0.77459666924148337704E+00, -0.75748396638051363793E+00,
				-0.73975604435269475868E+00, -0.72142308537009891548E+00,
				-0.70249620649152707861E+00, -0.68298743109107922809E+00,
				-0.66290966002478059546E+00, -0.64227664250975951377E+00,
				-0.62110294673722640294E+00, -0.59940393024224289297E+00,
				-0.57719571005204581484E+00, -0.55449513263193254887E+00,
				-0.53131974364437562397E+00, -0.50768775753371660215E+00,
				-0.48361802694584102756E+00, -0.45913001198983233287E+00,
				-0.43424374934680255800E+00, -0.40897982122988867241E+00,
				-0.38335932419873034692E+00, -0.35740383783153215238E+00,
				-0.33113539325797683309E+00, -0.30457644155671404334E+00,
				-0.27774982202182431507E+00, -0.25067873030348317661E+00,
				-0.22338668642896688163E+00, -0.19589750271110015392E+00,
				-0.16823525155220746498E+00, -0.14042423315256017459E+00,
				-0.11248894313318662575E+00, -0.084454040083710883710E+00,
				-0.056344313046592789972E+00, -0.028184648949745694339E+00,
				0.0E+00, 0.028184648949745694339E+00,
				0.056344313046592789972E+00, 0.084454040083710883710E+00,
				0.11248894313318662575E+00, 0.14042423315256017459E+00,
				0.16823525155220746498E+00, 0.19589750271110015392E+00,
				0.22338668642896688163E+00, 0.25067873030348317661E+00,
				0.27774982202182431507E+00, 0.30457644155671404334E+00,
				0.33113539325797683309E+00, 0.35740383783153215238E+00,
				0.38335932419873034692E+00, 0.40897982122988867241E+00,
				0.43424374934680255800E+00, 0.45913001198983233287E+00,
				0.48361802694584102756E+00, 0.50768775753371660215E+00,
				0.53131974364437562397E+00, 0.55449513263193254887E+00,
				0.57719571005204581484E+00, 0.59940393024224289297E+00,
				0.62110294673722640294E+00, 0.64227664250975951377E+00,
				0.66290966002478059546E+00, 0.68298743109107922809E+00,
				0.70249620649152707861E+00, 0.72142308537009891548E+00,
				0.73975604435269475868E+00, 0.75748396638051363793E+00,
				0.77459666924148337704E+00, 0.79108493379984836143E+00,
				0.80694053195021761186E+00, 0.82215625436498040737E+00,
				0.83672593816886873550E+00, 0.85064449476835027976E+00,
				0.86390793819369047715E+00, 0.87651341448470526974E+00,
				0.88845923287225699889E+00, 0.89974489977694003664E+00,
				0.91037115695700429250E+00, 0.92034002547001242073E+00,
				0.92965485742974005667E+00, 0.93832039777959288365E+00,
				0.94634285837340290515E+00, 0.95373000642576113641E+00,
				0.96049126870802028342E+00, 0.96663785155841656709E+00,
				0.97218287474858179658E+00, 0.97714151463970571416E+00,
				0.98153114955374010687E+00, 0.98537149959852037111E+00,
				0.98868475754742947994E+00, 0.99149572117810613240E+00,
				0.99383196321275502221E+00, 0.99572410469840718851E+00,
				0.99720625937222195908E+00, 0.99831663531840739253E+00,
				0.99909812496766759766E+00, 0.99959879967191068325E+00,
				0.99987288812035761194E+00, 0.99998243035489159858E+00, 1.0 };
		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));
		break;
	}
	case 8: {
		int nr_pts = 257;
		double abscissas[257] = { -1.0, -0.99999759637974846462E+00,
				-0.99998243035489159858E+00, -0.99994399620705437576E+00,
				-0.99987288812035761194E+00, -0.99976049092443204733E+00,
				-0.99959879967191068325E+00, -0.99938033802502358193E+00,
				-0.99909812496766759766E+00, -0.99874561446809511470E+00,
				-0.99831663531840739253E+00, -0.99780535449595727456E+00,
				-0.99720625937222195908E+00, -0.99651414591489027385E+00,
				-0.99572410469840718851E+00, -0.99483150280062100052E+00,
				-0.99383196321275502221E+00, -0.99272134428278861533E+00,
				-0.99149572117810613240E+00, -0.99015137040077015918E+00,
				-0.98868475754742947994E+00, -0.98709252795403406719E+00,
				-0.98537149959852037111E+00, -0.98351865757863272876E+00,
				-0.98153114955374010687E+00, -0.97940628167086268381E+00,
				-0.97714151463970571416E+00, -0.97473445975240266776E+00,
				-0.97218287474858179658E+00, -0.96948465950245923177E+00,
				-0.96663785155841656709E+00, -0.96364062156981213252E+00,
				-0.96049126870802028342E+00, -0.95718821610986096274E+00,
				-0.95373000642576113641E+00, -0.95011529752129487656E+00,
				-0.94634285837340290515E+00, -0.94241156519108305981E+00,
				-0.93832039777959288365E+00, -0.93406843615772578800E+00,
				-0.92965485742974005667E+00, -0.92507893290707565236E+00,
				-0.92034002547001242073E+00, -0.91543758715576504064E+00,
				-0.91037115695700429250E+00, -0.90514035881326159519E+00,
				-0.89974489977694003664E+00, -0.89418456833555902286E+00,
				-0.88845923287225699889E+00, -0.88256884024734190684E+00,
				-0.87651341448470526974E+00, -0.87029305554811390585E+00,
				-0.86390793819369047715E+00, -0.85735831088623215653E+00,
				-0.85064449476835027976E+00, -0.84376688267270860104E+00,
				-0.83672593816886873550E+00, -0.82952219463740140018E+00,
				-0.82215625436498040737E+00, -0.81462878765513741344E+00,
				-0.80694053195021761186E+00, -0.79909229096084140180E+00,
				-0.79108493379984836143E+00, -0.78291939411828301639E+00,
				-0.77459666924148337704E+00, -0.76611781930376009072E+00,
				-0.75748396638051363793E+00, -0.74869629361693660282E+00,
				-0.73975604435269475868E+00, -0.73066452124218126133E+00,
				-0.72142308537009891548E+00, -0.71203315536225203459E+00,
				-0.70249620649152707861E+00, -0.69281376977911470289E+00,
				-0.68298743109107922809E+00, -0.67301883023041847920E+00,
				-0.66290966002478059546E+00, -0.65266166541001749610E+00,
				-0.64227664250975951377E+00, -0.63175643771119423041E+00,
				-0.62110294673722640294E+00, -0.61031811371518640016E+00,
				-0.59940393024224289297E+00, -0.58836243444766254143E+00,
				-0.57719571005204581484E+00, -0.56590588542365442262E+00,
				-0.55449513263193254887E+00, -0.54296566649831149049E+00,
				-0.53131974364437562397E+00, -0.51955966153745702199E+00,
				-0.50768775753371660215E+00, -0.49570640791876146017E+00,
				-0.48361802694584102756E+00, -0.47142506587165887693E+00,
				-0.45913001198983233287E+00, -0.44673538766202847374E+00,
				-0.43424374934680255800E+00, -0.42165768662616330006E+00,
				-0.40897982122988867241E+00, -0.39621280605761593918E+00,
				-0.38335932419873034692E+00, -0.37042208795007823014E+00,
				-0.35740383783153215238E+00, -0.34430734159943802278E+00,
				-0.33113539325797683309E+00, -0.31789081206847668318E+00,
				-0.30457644155671404334E+00, -0.29119514851824668196E+00,
				-0.27774982202182431507E+00, -0.26424337241092676194E+00,
				-0.25067873030348317661E+00, -0.23705884558982972721E+00,
				-0.22338668642896688163E+00, -0.20966523824318119477E+00,
				-0.19589750271110015392E+00, -0.18208649675925219825E+00,
				-0.16823525155220746498E+00, -0.15434681148137810869E+00,
				-0.14042423315256017459E+00, -0.12647058437230196685E+00,
				-0.11248894313318662575E+00, -0.098482396598119202090E+00,
				-0.084454040083710883710E+00, -0.070406976042855179063E+00,
				-0.056344313046592789972E+00, -0.042269164765363603212E+00,
				-0.028184648949745694339E+00, -0.014093886410782462614E+00,
				0.0E+00, 0.014093886410782462614E+00,
				0.028184648949745694339E+00, 0.042269164765363603212E+00,
				0.056344313046592789972E+00, 0.070406976042855179063E+00,
				0.084454040083710883710E+00, 0.098482396598119202090E+00,
				0.11248894313318662575E+00, 0.12647058437230196685E+00,
				0.14042423315256017459E+00, 0.15434681148137810869E+00,
				0.16823525155220746498E+00, 0.18208649675925219825E+00,
				0.19589750271110015392E+00, 0.20966523824318119477E+00,
				0.22338668642896688163E+00, 0.23705884558982972721E+00,
				0.25067873030348317661E+00, 0.26424337241092676194E+00,
				0.27774982202182431507E+00, 0.29119514851824668196E+00,
				0.30457644155671404334E+00, 0.31789081206847668318E+00,
				0.33113539325797683309E+00, 0.34430734159943802278E+00,
				0.35740383783153215238E+00, 0.37042208795007823014E+00,
				0.38335932419873034692E+00, 0.39621280605761593918E+00,
				0.40897982122988867241E+00, 0.42165768662616330006E+00,
				0.43424374934680255800E+00, 0.44673538766202847374E+00,
				0.45913001198983233287E+00, 0.47142506587165887693E+00,
				0.48361802694584102756E+00, 0.49570640791876146017E+00,
				0.50768775753371660215E+00, 0.51955966153745702199E+00,
				0.53131974364437562397E+00, 0.54296566649831149049E+00,
				0.55449513263193254887E+00, 0.56590588542365442262E+00,
				0.57719571005204581484E+00, 0.58836243444766254143E+00,
				0.59940393024224289297E+00, 0.61031811371518640016E+00,
				0.62110294673722640294E+00, 0.63175643771119423041E+00,
				0.64227664250975951377E+00, 0.65266166541001749610E+00,
				0.66290966002478059546E+00, 0.67301883023041847920E+00,
				0.68298743109107922809E+00, 0.69281376977911470289E+00,
				0.70249620649152707861E+00, 0.71203315536225203459E+00,
				0.72142308537009891548E+00, 0.73066452124218126133E+00,
				0.73975604435269475868E+00, 0.74869629361693660282E+00,
				0.75748396638051363793E+00, 0.76611781930376009072E+00,
				0.77459666924148337704E+00, 0.78291939411828301639E+00,
				0.79108493379984836143E+00, 0.79909229096084140180E+00,
				0.80694053195021761186E+00, 0.81462878765513741344E+00,
				0.82215625436498040737E+00, 0.82952219463740140018E+00,
				0.83672593816886873550E+00, 0.84376688267270860104E+00,
				0.85064449476835027976E+00, 0.85735831088623215653E+00,
				0.86390793819369047715E+00, 0.87029305554811390585E+00,
				0.87651341448470526974E+00, 0.88256884024734190684E+00,
				0.88845923287225699889E+00, 0.89418456833555902286E+00,
				0.89974489977694003664E+00, 0.90514035881326159519E+00,
				0.91037115695700429250E+00, 0.91543758715576504064E+00,
				0.92034002547001242073E+00, 0.92507893290707565236E+00,
				0.92965485742974005667E+00, 0.93406843615772578800E+00,
				0.93832039777959288365E+00, 0.94241156519108305981E+00,
				0.94634285837340290515E+00, 0.95011529752129487656E+00,
				0.95373000642576113641E+00, 0.95718821610986096274E+00,
				0.96049126870802028342E+00, 0.96364062156981213252E+00,
				0.96663785155841656709E+00, 0.96948465950245923177E+00,
				0.97218287474858179658E+00, 0.97473445975240266776E+00,
				0.97714151463970571416E+00, 0.97940628167086268381E+00,
				0.98153114955374010687E+00, 0.98351865757863272876E+00,
				0.98537149959852037111E+00, 0.98709252795403406719E+00,
				0.98868475754742947994E+00, 0.99015137040077015918E+00,
				0.99149572117810613240E+00, 0.99272134428278861533E+00,
				0.99383196321275502221E+00, 0.99483150280062100052E+00,
				0.99572410469840718851E+00, 0.99651414591489027385E+00,
				0.99720625937222195908E+00, 0.99780535449595727456E+00,
				0.99831663531840739253E+00, 0.99874561446809511470E+00,
				0.99909812496766759766E+00, 0.99938033802502358193E+00,
				0.99959879967191068325E+00, 0.99976049092443204733E+00,
				0.99987288812035761194E+00, 0.99994399620705437576E+00,
				0.99998243035489159858E+00, 0.99999759637974846462E+00, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}
	case 9: {
		int nr_pts = 513;
		double abscissas[513] =
				{ -1.0, -0.999999672956734384381E+00,
						-0.999997596379748464620E+00,
						-0.999992298136257588028E+00,
						-0.999982430354891598580E+00,
						-0.999966730098486276883E+00,
						-0.999943996207054375764E+00,
						-0.999913081144678282800E+00,
						-0.999872888120357611938E+00,
						-0.999822363679787739196E+00,
						-0.999760490924432047330E+00,
						-0.999686286448317731776E+00,
						-0.999598799671910683252E+00,
						-0.999497112467187190535E+00,
						-0.999380338025023581928E+00,
						-0.999247618943342473599E+00,
						-0.999098124967667597662E+00,
						-0.998931050830810562236E+00,
						-0.998745614468095114704E+00,
						-0.998541055697167906027E+00,
						-0.998316635318407392531E+00,
						-0.998071634524930323302E+00,
						-0.997805354495957274562E+00,
						-0.997517116063472399965E+00,
						-0.997206259372221959076E+00,
						-0.996872143485260161299E+00,
						-0.996514145914890273849E+00,
						-0.996131662079315037786E+00,
						-0.995724104698407188509E+00,
						-0.995290903148810302261E+00,
						-0.994831502800621000519E+00,
						-0.994345364356723405931E+00,
						-0.993831963212755022209E+00,
						-0.993290788851684966211E+00,
						-0.992721344282788615328E+00,
						-0.992123145530863117683E+00,
						-0.991495721178106132399E+00,
						-0.990838611958294243677E+00,
						-0.990151370400770159181E+00,
						-0.989433560520240838716E+00,
						-0.988684757547429479939E+00,
						-0.987904547695124280467E+00,
						-0.987092527954034067190E+00,
						-0.986248305913007552681E+00,
						-0.985371499598520371114E+00,
						-0.984461737328814534596E+00,
						-0.983518657578632728762E+00,
						-0.982541908851080604251E+00,
						-0.981531149553740106867E+00,
						-0.980486047876721339416E+00,
						-0.979406281670862683806E+00,
						-0.978291538324758539526E+00,
						-0.977141514639705714156E+00,
						-0.975955916702011753129E+00,
						-0.974734459752402667761E+00,
						-0.973476868052506926773E+00,
						-0.972182874748581796578E+00,
						-0.970852221732792443256E+00,
						-0.969484659502459231771E+00,
						-0.968079947017759947964E+00,
						-0.966637851558416567092E+00,
						-0.965158148579915665979E+00,
						-0.963640621569812132521E+00,
						-0.962085061904651475741E+00,
						-0.960491268708020283423E+00,
						-0.958859048710200221356E+00,
						-0.957188216109860962736E+00,
						-0.955478592438183697574E+00,
						-0.953730006425761136415E+00,
						-0.951942293872573589498E+00,
						-0.950115297521294876558E+00,
						-0.948248866934137357063E+00,
						-0.946342858373402905148E+00,
						-0.944397134685866648591E+00,
						-0.942411565191083059813E+00,
						-0.940386025573669721370E+00,
						-0.938320397779592883655E+00,
						-0.936214569916450806625E+00,
						-0.934068436157725787999E+00,
						-0.931881896650953639345E+00,
						-0.929654857429740056670E+00,
						-0.927387230329536696843E+00,
						-0.925078932907075652364E+00,
						-0.922729888363349241523E+00,
						-0.920340025470012420730E+00,
						-0.917909278499077501636E+00,
						-0.915437587155765040644E+00,
						-0.912924896514370590080E+00,
						-0.910371156957004292498E+00,
						-0.907776324115058903624E+00,
						-0.905140358813261595189E+00,
						-0.902463227016165675048E+00,
						-0.899744899776940036639E+00,
						-0.896985353188316590376E+00,
						-0.894184568335559022859E+00,
						-0.891342531251319871666E+00,
						-0.888459232872256998890E+00,
						-0.885534668997285008926E+00,
						-0.882568840247341906842E+00,
						-0.879561752026556262568E+00,
						-0.876513414484705269742E+00,
						-0.873423842480859310192E+00,
						-0.870293055548113905851E+00,
						-0.867121077859315215614E+00,
						-0.863907938193690477146E+00,
						-0.860653669904299969802E+00,
						-0.857358310886232156525E+00,
						-0.854021903545468625813E+00,
						-0.850644494768350279758E+00,
						-0.847226135891580884381E+00,
						-0.843766882672708601038E+00,
						-0.840266795261030442350E+00,
						-0.836725938168868735503E+00,
						-0.833144380243172624728E+00,
						-0.829522194637401400178E+00,
						-0.825859458783650001088E+00,
						-0.822156254364980407373E+00,
						-0.818412667287925807395E+00,
						-0.814628787655137413436E+00,
						-0.810804709738146594361E+00,
						-0.806940531950217611856E+00,
						-0.803036356819268687782E+00,
						-0.799092290960841401800E+00,
						-0.795108445051100526780E+00,
						-0.791084933799848361435E+00,
						-0.787021875923539422170E+00,
						-0.782919394118283016385E+00,
						-0.778777615032822744702E+00,
						-0.774596669241483377036E+00,
						-0.770376691217076824278E+00,
						-0.766117819303760090717E+00,
						-0.761820195689839149173E+00,
						-0.757483966380513637926E+00,
						-0.753109281170558142523E+00,
						-0.748696293616936602823E+00,
						-0.744245161011347082309E+00,
						-0.739756044352694758677E+00,
						-0.735229108319491547663E+00,
						-0.730664521242181261329E+00,
						-0.726062455075389632685E+00,
						-0.721423085370098915485E+00,
						-0.716746591245747095767E+00,
						-0.712033155362252034587E+00,
						-0.707282963891961103412E+00,
						-0.702496206491527078610E+00,
						-0.697673076273711232906E+00,
						-0.692813769779114702895E+00,
						-0.687918486947839325756E+00,
						-0.682987431091079228087E+00,
						-0.678020808862644517838E+00,
						-0.673018830230418479199E+00,
						-0.667981708447749702165E+00,
						-0.662909660024780595461E+00,
						-0.657802904699713735422E+00,
						-0.652661665410017496101E+00,
						-0.647486168263572388782E+00,
						-0.642276642509759513774E+00,
						-0.637033320510492495071E+00,
						-0.631756437711194230414E+00,
						-0.626446232611719746542E+00,
						-0.621102946737226402941E+00,
						-0.615726824608992638014E+00,
						-0.610318113715186400156E+00,
						-0.604877064481584353319E+00,
						-0.599403930242242892974E+00,
						-0.593898967210121954393E+00,
						-0.588362434447662541434E+00,
						-0.582794593837318850840E+00,
						-0.577195710052045814844E+00,
						-0.571566050525742833992E+00,
						-0.565905885423654422623E+00,
						-0.560215487612728441818E+00,
						-0.554495132631932548866E+00,
						-0.548745098662529448608E+00,
						-0.542965666498311490492E+00,
						-0.537157119515795115982E+00,
						-0.531319743644375623972E+00,
						-0.525453827336442687395E+00,
						-0.519559661537457021993E+00,
						-0.513637539655988578507E+00,
						-0.507687757533716602155E+00,
						-0.501710613415391878251E+00,
						-0.495706407918761460170E+00,
						-0.489675444004456155436E+00,
						-0.483618026945841027562E+00,
						-0.477534464298829155284E+00,
						-0.471425065871658876934E+00,
						-0.465290143694634735858E+00,
						-0.459130011989832332874E+00,
						-0.452944987140767283784E+00,
						-0.446735387662028473742E+00,
						-0.440501534168875795783E+00,
						-0.434243749346802558002E+00,
						-0.427962357921062742583E+00,
						-0.421657686626163300056E+00,
						-0.415330064175321663764E+00,
						-0.408979821229888672409E+00,
						-0.402607290368737092671E+00,
						-0.396212806057615939183E+00,
						-0.389796704618470795479E+00,
						-0.383359324198730346916E+00,
						-0.376901004740559344802E+00,
						-0.370422087950078230138E+00,
						-0.363922917266549655269E+00,
						-0.357403837831532152376E+00,
						-0.350865196458001209011E+00,
						-0.344307341599438022777E+00,
						-0.337730623318886219621E+00,
						-0.331135393257976833093E+00,
						-0.324522004605921855207E+00,
						-0.317890812068476683182E+00,
						-0.311242171836871800300E+00,
						-0.304576441556714043335E+00,
						-0.297893980296857823437E+00,
						-0.291195148518246681964E+00,
						-0.284480308042725577496E+00,
						-0.277749822021824315065E+00,
						-0.271004054905512543536E+00,
						-0.264243372410926761945E+00,
						-0.257468141491069790481E+00,
						-0.250678730303483176613E+00,
						-0.243875508178893021593E+00,
						-0.237058845589829727213E+00,
						-0.230229114119222177156E+00,
						-0.223386686428966881628E+00,
						-0.216531936228472628081E+00,
						-0.209665238243181194766E+00,
						-0.202786968183064697557E+00,
						-0.195897502711100153915E+00,
						-0.188997219411721861059E+00,
						-0.182086496759252198246E+00,
						-0.175165714086311475707E+00,
						-0.168235251552207464982E+00,
						-0.161295490111305257361E+00,
						-0.154346811481378108692E+00,
						-0.147389598111939940054E+00,
						-0.140424233152560174594E+00,
						-0.133451100421161601344E+00,
						-0.126470584372301966851E+00,
						-0.119483070065440005133E+00,
						-0.112488943133186625746E+00,
						-0.105488589749541988533E+00,
						-0.984823965981192020903E-01,
						-0.914707508403553909095E-01,
						-0.844540400837108837102E-01,
						-0.774326523498572825675E-01,
						-0.704069760428551790633E-01,
						-0.633773999173222898797E-01,
						-0.563443130465927899720E-01,
						-0.493081047908686267156E-01,
						-0.422691647653636032124E-01,
						-0.352278828084410232603E-01,
						-0.281846489497456943394E-01,
						-0.211398533783310883350E-01,
						-0.140938864107824626142E-01,
						-0.704713845933674648514E-02,
						+0.000000000000000000000E+00,
						+0.704713845933674648514E-02,
						+0.140938864107824626142E-01,
						+0.211398533783310883350E-01,
						+0.281846489497456943394E-01,
						+0.352278828084410232603E-01,
						+0.422691647653636032124E-01,
						+0.493081047908686267156E-01,
						+0.563443130465927899720E-01,
						+0.633773999173222898797E-01,
						+0.704069760428551790633E-01,
						+0.774326523498572825675E-01,
						+0.844540400837108837102E-01,
						+0.914707508403553909095E-01,
						+0.984823965981192020903E-01,
						+0.105488589749541988533E+00,
						+0.112488943133186625746E+00,
						+0.119483070065440005133E+00,
						+0.126470584372301966851E+00,
						+0.133451100421161601344E+00,
						+0.140424233152560174594E+00,
						+0.147389598111939940054E+00,
						+0.154346811481378108692E+00,
						+0.161295490111305257361E+00,
						+0.168235251552207464982E+00,
						+0.175165714086311475707E+00,
						+0.182086496759252198246E+00,
						+0.188997219411721861059E+00,
						+0.195897502711100153915E+00,
						+0.202786968183064697557E+00,
						+0.209665238243181194766E+00,
						+0.216531936228472628081E+00,
						+0.223386686428966881628E+00,
						+0.230229114119222177156E+00,
						+0.237058845589829727213E+00,
						+0.243875508178893021593E+00,
						+0.250678730303483176613E+00,
						+0.257468141491069790481E+00,
						+0.264243372410926761945E+00,
						+0.271004054905512543536E+00,
						+0.277749822021824315065E+00,
						+0.284480308042725577496E+00,
						+0.291195148518246681964E+00,
						+0.297893980296857823437E+00,
						+0.304576441556714043335E+00,
						+0.311242171836871800300E+00,
						+0.317890812068476683182E+00,
						+0.324522004605921855207E+00,
						+0.331135393257976833093E+00,
						+0.337730623318886219621E+00,
						+0.344307341599438022777E+00,
						+0.350865196458001209011E+00,
						+0.357403837831532152376E+00,
						+0.363922917266549655269E+00,
						+0.370422087950078230138E+00,
						+0.376901004740559344802E+00,
						+0.383359324198730346916E+00,
						+0.389796704618470795479E+00,
						+0.396212806057615939183E+00,
						+0.402607290368737092671E+00,
						+0.408979821229888672409E+00,
						+0.415330064175321663764E+00,
						+0.421657686626163300056E+00,
						+0.427962357921062742583E+00,
						+0.434243749346802558002E+00,
						+0.440501534168875795783E+00,
						+0.446735387662028473742E+00,
						+0.452944987140767283784E+00,
						+0.459130011989832332874E+00,
						+0.465290143694634735858E+00,
						+0.471425065871658876934E+00,
						+0.477534464298829155284E+00,
						+0.483618026945841027562E+00,
						+0.489675444004456155436E+00,
						+0.495706407918761460170E+00,
						+0.501710613415391878251E+00,
						+0.507687757533716602155E+00,
						+0.513637539655988578507E+00,
						+0.519559661537457021993E+00,
						+0.525453827336442687395E+00,
						+0.531319743644375623972E+00,
						+0.537157119515795115982E+00,
						+0.542965666498311490492E+00,
						+0.548745098662529448608E+00,
						+0.554495132631932548866E+00,
						+0.560215487612728441818E+00,
						+0.565905885423654422623E+00,
						+0.571566050525742833992E+00,
						+0.577195710052045814844E+00,
						+0.582794593837318850840E+00,
						+0.588362434447662541434E+00,
						+0.593898967210121954393E+00,
						+0.599403930242242892974E+00,
						+0.604877064481584353319E+00,
						+0.610318113715186400156E+00,
						+0.615726824608992638014E+00,
						+0.621102946737226402941E+00,
						+0.626446232611719746542E+00,
						+0.631756437711194230414E+00,
						+0.637033320510492495071E+00,
						+0.642276642509759513774E+00,
						+0.647486168263572388782E+00,
						+0.652661665410017496101E+00,
						+0.657802904699713735422E+00,
						+0.662909660024780595461E+00,
						+0.667981708447749702165E+00,
						+0.673018830230418479199E+00,
						+0.678020808862644517838E+00,
						+0.682987431091079228087E+00,
						+0.687918486947839325756E+00,
						+0.692813769779114702895E+00,
						+0.697673076273711232906E+00,
						+0.702496206491527078610E+00,
						+0.707282963891961103412E+00,
						+0.712033155362252034587E+00,
						+0.716746591245747095767E+00,
						+0.721423085370098915485E+00,
						+0.726062455075389632685E+00,
						+0.730664521242181261329E+00,
						+0.735229108319491547663E+00,
						+0.739756044352694758677E+00,
						+0.744245161011347082309E+00,
						+0.748696293616936602823E+00,
						+0.753109281170558142523E+00,
						+0.757483966380513637926E+00,
						+0.761820195689839149173E+00,
						+0.766117819303760090717E+00,
						+0.770376691217076824278E+00,
						+0.774596669241483377036E+00,
						+0.778777615032822744702E+00,
						+0.782919394118283016385E+00,
						+0.787021875923539422170E+00,
						+0.791084933799848361435E+00,
						+0.795108445051100526780E+00,
						+0.799092290960841401800E+00,
						+0.803036356819268687782E+00,
						+0.806940531950217611856E+00,
						+0.810804709738146594361E+00,
						+0.814628787655137413436E+00,
						+0.818412667287925807395E+00,
						+0.822156254364980407373E+00,
						+0.825859458783650001088E+00,
						+0.829522194637401400178E+00,
						+0.833144380243172624728E+00,
						+0.836725938168868735503E+00,
						+0.840266795261030442350E+00,
						+0.843766882672708601038E+00,
						+0.847226135891580884381E+00,
						+0.850644494768350279758E+00,
						+0.854021903545468625813E+00,
						+0.857358310886232156525E+00,
						+0.860653669904299969802E+00,
						+0.863907938193690477146E+00,
						+0.867121077859315215614E+00,
						+0.870293055548113905851E+00,
						+0.873423842480859310192E+00,
						+0.876513414484705269742E+00,
						+0.879561752026556262568E+00,
						+0.882568840247341906842E+00,
						+0.885534668997285008926E+00,
						+0.888459232872256998890E+00,
						+0.891342531251319871666E+00,
						+0.894184568335559022859E+00,
						+0.896985353188316590376E+00,
						+0.899744899776940036639E+00,
						+0.902463227016165675048E+00,
						+0.905140358813261595189E+00,
						+0.907776324115058903624E+00,
						+0.910371156957004292498E+00,
						+0.912924896514370590080E+00,
						+0.915437587155765040644E+00,
						+0.917909278499077501636E+00,
						+0.920340025470012420730E+00,
						+0.922729888363349241523E+00,
						+0.925078932907075652364E+00,
						+0.927387230329536696843E+00,
						+0.929654857429740056670E+00,
						+0.931881896650953639345E+00,
						+0.934068436157725787999E+00,
						+0.936214569916450806625E+00,
						+0.938320397779592883655E+00,
						+0.940386025573669721370E+00,
						+0.942411565191083059813E+00,
						+0.944397134685866648591E+00,
						+0.946342858373402905148E+00,
						+0.948248866934137357063E+00,
						+0.950115297521294876558E+00,
						+0.951942293872573589498E+00,
						+0.953730006425761136415E+00,
						+0.955478592438183697574E+00,
						+0.957188216109860962736E+00,
						+0.958859048710200221356E+00,
						+0.960491268708020283423E+00,
						+0.962085061904651475741E+00,
						+0.963640621569812132521E+00,
						+0.965158148579915665979E+00,
						+0.966637851558416567092E+00,
						+0.968079947017759947964E+00,
						+0.969484659502459231771E+00,
						+0.970852221732792443256E+00,
						+0.972182874748581796578E+00,
						+0.973476868052506926773E+00,
						+0.974734459752402667761E+00,
						+0.975955916702011753129E+00,
						+0.977141514639705714156E+00,
						+0.978291538324758539526E+00,
						+0.979406281670862683806E+00,
						+0.980486047876721339416E+00,
						+0.981531149553740106867E+00,
						+0.982541908851080604251E+00,
						+0.983518657578632728762E+00,
						+0.984461737328814534596E+00,
						+0.985371499598520371114E+00,
						+0.986248305913007552681E+00,
						+0.987092527954034067190E+00,
						+0.987904547695124280467E+00,
						+0.988684757547429479939E+00,
						+0.989433560520240838716E+00,
						+0.990151370400770159181E+00,
						+0.990838611958294243677E+00,
						+0.991495721178106132399E+00,
						+0.992123145530863117683E+00,
						+0.992721344282788615328E+00,
						+0.993290788851684966211E+00,
						+0.993831963212755022209E+00,
						+0.994345364356723405931E+00,
						+0.994831502800621000519E+00,
						+0.995290903148810302261E+00,
						+0.995724104698407188509E+00,
						+0.996131662079315037786E+00,
						+0.996514145914890273849E+00,
						+0.996872143485260161299E+00,
						+0.997206259372221959076E+00,
						+0.997517116063472399965E+00,
						+0.997805354495957274562E+00,
						+0.998071634524930323302E+00,
						+0.998316635318407392531E+00,
						+0.998541055697167906027E+00,
						+0.998745614468095114704E+00,
						+0.998931050830810562236E+00,
						+0.999098124967667597662E+00,
						+0.999247618943342473599E+00,
						+0.999380338025023581928E+00,
						+0.999497112467187190535E+00,
						+0.999598799671910683252E+00,
						+0.999686286448317731776E+00,
						+0.999760490924432047330E+00,
						+0.999822363679787739196E+00,
						+0.999872888120357611938E+00,
						+0.999913081144678282800E+00,
						+0.999943996207054375764E+00,
						+0.999966730098486276883E+00,
						+0.999982430354891598580E+00,
						+0.999992298136257588028E+00,
						+0.999997596379748464620E+00,
						+0.999999672956734384381E+00, 1.0 };

		stretching.push_back(min);
		jacobian.push_back(transformationJacobian(min, max, -1.0, type));
		for (int d = 1; d < nr_pts - 1; d++) {
			stretching.push_back(
					transforminterval(min, max, abscissas[d], type));
			jacobian.push_back(
					transformationJacobian(min, max, abscissas[d], type));
		}

		stretching.push_back(max);
		jacobian.push_back(transformationJacobian(min, max, 1.0, type));

		break;
	}
	default: {
		COMBIGRID_OUT_WRN(
				"\nSorry for the inconvenience\n,"
				"but I am not such a genius!\n"
				"I cannot support the quadrature of Gauss-LEGENDRE (Patterson does not rhyme with surrender),\n"
				"cuz to its complexity I do SURRENDER\n, "
				"So PLEASE, \n "
				"the grid level you DECREASE,\n....(max supported level is 9)....\n"
				"for I have only pre-computed\n"
				"coefficients up to level NINE INCLUSIVE...\n\n"
				"Sincerely yours (since the day you bought me),\n"
				"CPU\n", __FILE__, __LINE__)

		int nr_pts = powerOfTwo[level] + 1;
		stretching.resize(nr_pts, 0.0);
		break;
	}

	}
}

