<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SG++-Doxygen-Documentation: refinement.py</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
  TeX: {
    Macros: {
      vec: ["\\boldsymbol{#1}", 1],
      opt: "\\mathrm{opt}",
      norm: ["\\lVert{#1}\\rVert", 1]
    }
  }
}); 
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sgpp_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">SG++-Doxygen-Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('example_refinement_py.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">refinement.py</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Here we demonstrate how to refine a grid.</p>
<p>As a refinement indicator, we take the surpluses of the grid points directly. We start with a regular sparse grid of level 3 with linear basis functions and refine five times. In each refinement step, we refine the grid point with the highest absolute surplus.</p>
<p>The following example interpolates the (non-symmetric) function  </p><p class="formulaDsp">
\[
   f\colon [0, 1]^2 \to \mathbb{R},\quad
   f(x_0, x_1) := 16 (x_0 - 1) x_0 (x_1 - 1) x_1
 \]
</p>
<p>The number of grid points is printed in each iteration. After refinement, the surplusses have to be set for all new grid points, i.e., the alpha-Vector has to be extended. </p><div class="fragment"><div class="line"><span class="comment"># import pysgpp library</span></div>
<div class="line"><span class="keyword">import</span> pysgpp</div>
</div><!-- fragment --><p>create a two-dimensional piecewise bi-linear grid </p><div class="fragment"><div class="line">dim = 2</div>
<div class="line">grid = pysgpp.Grid.createLinearGrid(dim)</div>
<div class="line">gridStorage = grid.getStorage()</div>
<div class="line">print(<span class="stringliteral">&quot;dimensionality:                   {}&quot;</span>.format(dim))</div>
</div><!-- fragment --><p>create regular sparse grid, level 3 </p><div class="fragment"><div class="line">level = 3</div>
<div class="line">gridGen = grid.getGenerator()</div>
<div class="line">gridGen.regular(level)</div>
<div class="line">print(<span class="stringliteral">&quot;number of initial grid points:    {}&quot;</span>.format(gridStorage.getSize()))</div>
</div><!-- fragment --><p>function to interpolate. This is a two-dimensional parabola. - nonsymmetric(!) </p><div class="fragment"><div class="line">f = <span class="keyword">lambda</span> x0, x1: 16.0 * (x0-1)*x0 * (x1-1)*x1*x1</div>
</div><!-- fragment --><p>create coefficient vector with size corresponding to the grid size. Initially, all the values are set to zero. </p><div class="fragment"><div class="line">alpha = pysgpp.DataVector(gridStorage.getSize())</div>
<div class="line">print(<span class="stringliteral">&quot;length of alpha vector:           {}&quot;</span>.format(alpha.getSize()))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Obtain function values and refine adaptively 5 times</span></div>
<div class="line"><span class="keywordflow">for</span> refnum <span class="keywordflow">in</span> range(5):</div>
<div class="line">    <span class="comment"># set function values in alpha</span></div>
<div class="line">    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(gridStorage.getSize()):</div>
<div class="line">        gp = gridStorage.getPoint(i)</div>
<div class="line">        alpha[i] = <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(gp.getStandardCoordinate(0), gp.getStandardCoordinate(1))</div>
<div class="ttc" id="aAugmentedLagrangian_8cpp_html_ac2eaf9e806b463971eb23d43900a64be"><div class="ttname"><a href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a></div><div class="ttdeci">base::ScalarFunction &amp; f</div><div class="ttdef"><b>Definition</b> AugmentedLagrangian.cpp:75</div></div>
</div><!-- fragment --><p>Each time, we have to hierarchize the grid again, because in the previous interation, new grid points have been added. </p><div class="fragment"><div class="line">    pysgpp.createOperationHierarchisation(grid).doHierarchisation(alpha)</div>
</div><!-- fragment --><p>Refine a single grid point each time. The SurplusRefinementFunctor chooses the grid point with the highest absolute surplus. Refining the point means, that all children of this point (if not already present) are added to the grid. Also all missing parents are added (recursively). </p><div class="fragment"><div class="line">    gridGen.refine(pysgpp.SurplusRefinementFunctor(alpha, 1))</div>
<div class="line">    print(<span class="stringliteral">&quot;refinement step {}, new grid size: {}&quot;</span>.format(refnum+1, gridStorage.getSize()))</div>
</div><!-- fragment --><p>Extend alpha vector (new entries uninitialized). Note that right now, the surplus vector has the correct size again, but the values of the new points are set to zero. The correct surplus values will be inserted in the next iteration of the refinement loop. </p><div class="fragment"><div class="line">    alpha.resizeZero(gridStorage.getSize())</div>
</div><!-- fragment --><p>This results in the following output: </p><pre class="fragment">dimensionality:                   2
number of initial grid points:    17
length of alpha vector:           17
refinement step 1, new grid size: 21
refinement step 2, new grid size: 24
refinement step 3, new grid size: 27
refinement step 4, new grid size: 29
refinement step 5, new grid size: 33</pre><p>There are clearly more efficient approaches than to set the function values for all grid points and to hierarchize the whole grid each time. But this works even where no efficient alternatives are available and suffices for demonstration purposes.</p>
<p>This use of the SurplusRefinementFunctor takes as arguments the coefficient vector (it doesn't have to be the coefficient vector, it could be something modified!) and the number of grid points to refine (if available). It bases its refinement decision on the absolute values of the vector's entries, choosing the largest ones. Other refinement functors are available or can be implemented. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="examples.html">Usage Examples</a></li><li class="navelem"><a class="el" href="examples_py.html">Python Examples</a></li>
    <li class="footer">Generated on Mon Feb 24 2025 09:29:11 for SG++-Doxygen-Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
