<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SG++-Doxygen-Documentation: Refinement Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
  TeX: {
    Macros: {
      vec: ["\\boldsymbol{#1}", 1],
      opt: "\\mathrm{opt}",
      norm: ["\\lVert{#1}\\rVert", 1]
    }
  }
}); 
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sgpp_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">SG++-Doxygen-Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('example_refinement_java.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Refinement Example</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Here we demonstrate how to refine a grid.</p>
<p>As a refinement indicator, we take the surpluses of the grid points directly. We start with a regular sparse grid of level 3 with linear basis functions and refine five times. In each refinement step, we refine the grid point with the highest absolute surplus.</p>
<p>The following example interpolates the (non-symmetric) function f : [0,1]x[0,1] -&gt; R, <a class="el" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f(x,y)</a> := 16 (x-1) * x * (y-1) * y</p>
<p>The number of grid points is printed in each iteration. After refinement, the surplusses have to be set for all new grid points, i.e., the alpha-Vector has to be extended. </p><div class="fragment"><div class="line"><span class="keyword">import</span> <a class="code hl_namespace" href="namespacesgpp.html">sgpp</a>.*;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>refinement {</div>
<div class="ttc" id="anamespacesgpp_html"><div class="ttname"><a href="namespacesgpp.html">sgpp</a></div><div class="ttdoc">Class that stores, generates and manipulates a density function during online phase in on/off learnin...</div><div class="ttdef"><b>Definition</b> AlgorithmDGEMV.hpp:22</div></div>
</div><!-- fragment --><p>function to interpolate. This is a two-dimensional parabola. - nonsymmetric(!) </p><div class="fragment"><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> x1) {</div>
<div class="line">    <span class="keywordflow">return</span> 16.0 * (x0 - 1.0) * x0 * (x1 - 1.0) * x1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="densityMultiplication_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(String[] args) {</div>
<div class="line">    <a class="code hl_namespace" href="namespacesgpp.html">sgpp</a>.LoadJSGPPLib.loadJSGPPLib();</div>
<div class="ttc" id="aAugmentedLagrangian_8cpp_html_ac2eaf9e806b463971eb23d43900a64be"><div class="ttname"><a href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a></div><div class="ttdeci">base::ScalarFunction &amp; f</div><div class="ttdef"><b>Definition</b> AugmentedLagrangian.cpp:75</div></div>
<div class="ttc" id="adensityMultiplication_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="densityMultiplication_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> densityMultiplication.cpp:22</div></div>
</div><!-- fragment --><p>create a two-dimensional piecewise bi-linear grid </p><div class="fragment"><div class="line">    <span class="keywordtype">int</span> dim = 2;</div>
<div class="line">    Grid <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a> = Grid.createLinearGrid(dim);</div>
<div class="line">    GridStorage gridStorage = <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>.getStorage();</div>
<div class="line">    System.out.println(<span class="stringliteral">&quot;dimensionality:                   &quot;</span> + gridStorage.getDimension());</div>
<div class="line"> </div>
<div class="ttc" id="amultHPX_8cpp_html_ae871abe991ec98e4b1c09a6eaa9f1ddc"><div class="ttname"><a href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a></div><div class="ttdeci">std::unique_ptr&lt; sgpp::base::Grid &gt; grid(nullptr)</div></div>
</div><!-- fragment --><p>create regular sparse grid, level 3 </p><div class="fragment"><div class="line">    <span class="keywordtype">int</span> <a class="code hl_variable" href="multHPX_8cpp.html#a6a330c3b2adf87bfa27e9a9450d8bc40">level</a> = 3;</div>
<div class="line">    <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>.getGenerator().regular(<a class="code hl_variable" href="multHPX_8cpp.html#a6a330c3b2adf87bfa27e9a9450d8bc40">level</a>);</div>
<div class="line">    System.out.println(<span class="stringliteral">&quot;number of initial grid points:    &quot;</span> + gridStorage.getSize());</div>
<div class="line"> </div>
<div class="ttc" id="amultHPX_8cpp_html_a6a330c3b2adf87bfa27e9a9450d8bc40"><div class="ttname"><a href="multHPX_8cpp.html#a6a330c3b2adf87bfa27e9a9450d8bc40">level</a></div><div class="ttdeci">uint32_t level</div><div class="ttdef"><b>Definition</b> multHPX.cpp:26</div></div>
</div><!-- fragment --><p>create coefficient vector with size corresponding to the grid size. Initially, all the values are set to zero. </p><div class="fragment"><div class="line">    DataVector <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a> = <span class="keyword">new</span> DataVector(gridStorage.getSize());</div>
<div class="line">    <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>.<a class="code hl_function" href="classsgpp_1_1base_1_1DataVector.html#a75b0df6e46f9d8a4bdfaaa0636a3d55a">setAll</a>(0.0);</div>
<div class="line">    System.out.println(<span class="stringliteral">&quot;length of alpha vector:           &quot;</span> + <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>.<a class="code hl_function" href="classsgpp_1_1base_1_1DataVector.html#a4ec9b893255175cc583323968788b1b1">getSize</a>());</div>
<div class="ttc" id="aclasssgpp_1_1base_1_1DataVector_html_a4ec9b893255175cc583323968788b1b1"><div class="ttname"><a href="classsgpp_1_1base_1_1DataVector.html#a4ec9b893255175cc583323968788b1b1">sgpp::base::DataVector::getSize</a></div><div class="ttdeci">size_t getSize() const</div><div class="ttdoc">gets the elements stored in the vector</div><div class="ttdef"><b>Definition</b> DataVector.hpp:365</div></div>
<div class="ttc" id="aclasssgpp_1_1base_1_1DataVector_html_a75b0df6e46f9d8a4bdfaaa0636a3d55a"><div class="ttname"><a href="classsgpp_1_1base_1_1DataVector.html#a75b0df6e46f9d8a4bdfaaa0636a3d55a">sgpp::base::DataVector::setAll</a></div><div class="ttdeci">void setAll(double value)</div><div class="ttdoc">Sets all values of DataVector to value.</div><div class="ttdef"><b>Definition</b> DataVector.cpp:174</div></div>
<div class="ttc" id="amultHPX_8cpp_html_afaae4b3ccddbff855673417650052c63"><div class="ttname"><a href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a></div><div class="ttdeci">sgpp::base::DataVector alpha</div><div class="ttdef"><b>Definition</b> multHPX.cpp:40</div></div>
</div><!-- fragment --><p>Obtain function values and refine adaptively 5 times </p><div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = 0; step &lt; 5; step++) {</div>
<div class="line">      <span class="comment">// set function values in alpha</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gridStorage.getSize(); i++) {</div>
<div class="line">        GridPoint gp = gridStorage.getPoint(i);</div>
<div class="line">        <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>.<a class="code hl_function" href="classsgpp_1_1base_1_1DataVector.html#a6d0d2be0da12b23b4bf5a62048fb3e7a">set</a>(i, <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(gp.getStandardCoordinate(0), gp.getStandardCoordinate(1)));</div>
<div class="line">      }</div>
<div class="ttc" id="aclasssgpp_1_1base_1_1DataVector_html_a6d0d2be0da12b23b4bf5a62048fb3e7a"><div class="ttname"><a href="classsgpp_1_1base_1_1DataVector.html#a6d0d2be0da12b23b4bf5a62048fb3e7a">sgpp::base::DataVector::set</a></div><div class="ttdeci">void set(size_t i, double value)</div><div class="ttdoc">Sets the element at index i to value.</div><div class="ttdef"><b>Definition</b> DataVector.cpp:180</div></div>
</div><!-- fragment --><p>Each time, we have to hierarchize the grid again, because in the previous interation, new grid points have been added. </p><div class="fragment"><div class="line">      jsgpp.createOperationHierarchisation(<a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>).doHierarchisation(<a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>);</div>
</div><!-- fragment --><p>Refine a single grid point each time. The SurplusRefinementFunctor chooses the grid point with the highest absolute surplus. Refining the point means, that all children of this point (if not already present) are added to the grid. Also all missing parents are added (recursively). </p><div class="fragment"><div class="line">      SurplusRefinementFunctor functor = <span class="keyword">new</span> SurplusRefinementFunctor(<a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>, 1);</div>
<div class="line">      <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>.getGenerator().refine(functor);</div>
<div class="line">      System.out.println(<span class="stringliteral">&quot;refinement step &quot;</span> + (step + 1) + <span class="stringliteral">&quot;, new grid size: &quot;</span> + <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>.<a class="code hl_function" href="classsgpp_1_1base_1_1DataVector.html#a4ec9b893255175cc583323968788b1b1">getSize</a>());</div>
</div><!-- fragment --><p>Extend alpha vector (new entries uninitialized). Note that right now, the surplus vector has the correct size again, but the values of the new points are set to zero. The correct surplus values will be inserted in the next iteration of the refinement loop. </p><div class="fragment"><div class="line">      <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>.<a class="code hl_function" href="classsgpp_1_1base_1_1DataVector.html#ac64572eea568e37a84dccb2eab036e50">resizeZero</a>(gridStorage.getSize());</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclasssgpp_1_1base_1_1DataVector_html_ac64572eea568e37a84dccb2eab036e50"><div class="ttname"><a href="classsgpp_1_1base_1_1DataVector.html#ac64572eea568e37a84dccb2eab036e50">sgpp::base::DataVector::resizeZero</a></div><div class="ttdeci">void resizeZero(size_t nrows)</div><div class="ttdoc">Resizes the DataVector to size elements.</div><div class="ttdef"><b>Definition</b> DataVector.cpp:119</div></div>
</div><!-- fragment --><p>This results in the following output: </p><pre class="fragment">dimensionality:                   2
number of initial grid points:    17
length of alpha vector:           17
refinement step 1, new grid size: 21
refinement step 2, new grid size: 24
refinement step 3, new grid size: 27
refinement step 4, new grid size: 29
refinement step 5, new grid size: 33</pre><p>There are clearly more efficient approaches than to set the function values for all grid points and to hierarchize the whole grid each time. But this works even where no efficient alternatives are available and suffices for demonstration purposes.</p>
<p>This use of the SurplusRefinementFunctor takes as arguments the coefficient vector (it doesn't have to be the coefficient vector, it could be something modified!) and the number of grid points to refine (if available). It bases its refinement decision on the absolute values of the vector's entries, choosing the largest ones. Other refinement functors are available or can be implemented. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="examples.html">Usage Examples</a></li><li class="navelem"><a class="el" href="examples_java.html">Java Examples</a></li>
    <li class="footer">Generated on Thu Feb 13 2025 14:24:10 for SG++-Doxygen-Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
