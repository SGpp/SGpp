<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SG++-Doxygen-Documentation: Quadrature in C++</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
  TeX: {
    Macros: {
      vec: ["\\boldsymbol{#1}", 1],
      opt: "\\mathrm{opt}",
      norm: ["\\lVert{#1}\\rVert", 1]
    }
  }
}); 
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sgpp_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">SG++-Doxygen-Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('example_quadrature_cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Quadrature in C++</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The following example shows how to integrate in SG++, using both direct integration of a sparse grid function and the use of Monte Carlo integration.</p>
<p>As in the <a class="el" href="example_tutorial_cpp.html">tutorial.cpp (Start Here)</a> example, we deal with the function  </p><p class="formulaDsp">
\[
f\colon [0, 1]^2 \to \mathbb{R},\quad
f(x_0, x_1) := 16 (x_0 - 1) x_0 (x_1 - 1) x_1
\]
</p>
<p> which we first interpolate. We then integrate the interpolant, then the function itself using 100000 Monte Carlo points, and we then compute the L2-error.</p>
<p>The function, which <a class="el" href="classsgpp_1_1base_1_1OperationQuadratureMC.html" title="Quadrature on any sparse grid (that has OperationMultipleEval implemented) using Monte Carlo.">sgpp::base::OperationQuadratureMC</a> takes, has three parameters. First, the dimensionality (int), then a double* with the coordinates of the grid point \(\in[0,1]^d\), and finally a void* with clientdata for the function, see <a class="el" href="namespacesgpp_1_1base.html#a4066f2ba8be120a496d7d6202530e36e">sgpp::base::FUNC</a>. </p><div class="fragment"><div class="line"><span class="comment">// include all SG++ base headers</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sgpp__base_8hpp.html">sgpp_base.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_class" href="classsgpp_1_1base_1_1OperationHierarchisation.html">sgpp::base::OperationHierarchisation</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function to interpolate</span></div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(<span class="keywordtype">int</span> dim, <span class="keywordtype">double</span>* x, <span class="keywordtype">void</span>* clientdata) {</div>
<div class="line">  <span class="keywordtype">double</span> res = 1.0;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dim; i++) {</div>
<div class="line">    res *= 4.0 * x[i] * (1.0 - x[i]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> res;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="densityMultiplication_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="ttc" id="aAugmentedLagrangian_8cpp_html_ac2eaf9e806b463971eb23d43900a64be"><div class="ttname"><a href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a></div><div class="ttdeci">base::ScalarFunction &amp; f</div><div class="ttdef"><b>Definition</b> AugmentedLagrangian.cpp:75</div></div>
<div class="ttc" id="aclasssgpp_1_1base_1_1OperationHierarchisation_html"><div class="ttname"><a href="classsgpp_1_1base_1_1OperationHierarchisation.html">sgpp::base::OperationHierarchisation</a></div><div class="ttdoc">This class implements the hierarchisation and dehierarchisation on the sparse grid.</div><div class="ttdef"><b>Definition</b> OperationHierarchisation.hpp:19</div></div>
<div class="ttc" id="adensityMultiplication_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="densityMultiplication_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> densityMultiplication.cpp:22</div></div>
<div class="ttc" id="asgpp__base_8hpp_html"><div class="ttname"><a href="sgpp__base_8hpp.html">sgpp_base.hpp</a></div></div>
</div><!-- fragment --><p>Create a two-dimensional piecewise bi-linear grid of level 3 </p><div class="fragment"><div class="line">  <span class="keywordtype">int</span> dim = 2;</div>
<div class="line">  std::unique_ptr&lt;sgpp::base::Grid&gt; <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>(<a class="code hl_function" href="classsgpp_1_1base_1_1Grid.html#aedee852987dbba26cbb973ece5dea3db">sgpp::base::Grid::createLinearGrid</a>(dim));</div>
<div class="line">  <a class="code hl_class" href="classsgpp_1_1base_1_1HashGridStorage.html">sgpp::base::GridStorage</a>&amp; gridStorage = <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>-&gt;getStorage();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;dimensionality:        &quot;</span> &lt;&lt; gridStorage.getDimension() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// create regular grid, level 3</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="multHPX_8cpp.html#a6a330c3b2adf87bfa27e9a9450d8bc40">level</a> = 3;</div>
<div class="line">  <a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>-&gt;getGenerator().regular(<a class="code hl_variable" href="multHPX_8cpp.html#a6a330c3b2adf87bfa27e9a9450d8bc40">level</a>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;number of grid points: &quot;</span> &lt;&lt; gridStorage.getSize() &lt;&lt; std::endl;</div>
<div class="ttc" id="aclasssgpp_1_1base_1_1Grid_html_aedee852987dbba26cbb973ece5dea3db"><div class="ttname"><a href="classsgpp_1_1base_1_1Grid.html#aedee852987dbba26cbb973ece5dea3db">sgpp::base::Grid::createLinearGrid</a></div><div class="ttdeci">static Grid * createLinearGrid(size_t dim)</div><div class="ttdoc">Creates and returns a grid without grid points on the boundary (zero boundary conditions) with piecew...</div><div class="ttdef"><b>Definition</b> Grid.cpp:73</div></div>
<div class="ttc" id="aclasssgpp_1_1base_1_1HashGridStorage_html"><div class="ttname"><a href="classsgpp_1_1base_1_1HashGridStorage.html">sgpp::base::HashGridStorage</a></div><div class="ttdoc">Generic hash table based storage of grid points.</div><div class="ttdef"><b>Definition</b> HashGridStorage.hpp:42</div></div>
<div class="ttc" id="amultHPX_8cpp_html_a6a330c3b2adf87bfa27e9a9450d8bc40"><div class="ttname"><a href="multHPX_8cpp.html#a6a330c3b2adf87bfa27e9a9450d8bc40">level</a></div><div class="ttdeci">uint32_t level</div><div class="ttdef"><b>Definition</b> multHPX.cpp:26</div></div>
<div class="ttc" id="amultHPX_8cpp_html_ae871abe991ec98e4b1c09a6eaa9f1ddc"><div class="ttname"><a href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a></div><div class="ttdeci">std::unique_ptr&lt; sgpp::base::Grid &gt; grid(nullptr)</div></div>
</div><!-- fragment --><p>Calculate the surplus vector alpha for the interpolant of \(
f(x)\). Since the function can be evaluated at any point. Hence. we simply evaluate it at the coordinates of the grid points to obtain the nodal values. Then we use hierarchization to obtain the surplus value.</p>
<div class="fragment"><div class="line">  <a class="code hl_class" href="classsgpp_1_1base_1_1DataVector.html">sgpp::base::DataVector</a> <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>(gridStorage.getSize());</div>
<div class="line">  <span class="keywordtype">double</span> p[2];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; gridStorage.getSize(); i++) {</div>
<div class="line">    <a class="code hl_class" href="classsgpp_1_1base_1_1HashGridPoint.html">sgpp::base::GridPoint</a>&amp; gp = gridStorage.getPoint(i);</div>
<div class="line">    p[0] = gp.<a class="code hl_function" href="classsgpp_1_1base_1_1HashGridPoint.html#af7fd47e5ee557a38518b06f9787b7c1f">getStandardCoordinate</a>(0);</div>
<div class="line">    p[1] = gp.<a class="code hl_function" href="classsgpp_1_1base_1_1HashGridPoint.html#af7fd47e5ee557a38518b06f9787b7c1f">getStandardCoordinate</a>(1);</div>
<div class="line">    <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>[i] = <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(2, p, <span class="keyword">nullptr</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  std::unique_ptr&lt;OperationHierarchisation&gt;(<a class="code hl_function" href="namespacesgpp_1_1op__factory.html#a08b6aa545e0f57f47b5cfdafd4f781e4">sgpp::op_factory::createOperationHierarchisation</a>(*<a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>))</div>
<div class="line">      -&gt;doHierarchisation(<a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>);</div>
<div class="ttc" id="aclasssgpp_1_1base_1_1DataVector_html"><div class="ttname"><a href="classsgpp_1_1base_1_1DataVector.html">sgpp::base::DataVector</a></div><div class="ttdoc">A class to store one-dimensional data.</div><div class="ttdef"><b>Definition</b> DataVector.hpp:25</div></div>
<div class="ttc" id="aclasssgpp_1_1base_1_1HashGridPoint_html"><div class="ttname"><a href="classsgpp_1_1base_1_1HashGridPoint.html">sgpp::base::HashGridPoint</a></div><div class="ttdoc">This Class represents one Gridpoint.</div><div class="ttdef"><b>Definition</b> HashGridPoint.hpp:33</div></div>
<div class="ttc" id="aclasssgpp_1_1base_1_1HashGridPoint_html_af7fd47e5ee557a38518b06f9787b7c1f"><div class="ttname"><a href="classsgpp_1_1base_1_1HashGridPoint.html#af7fd47e5ee557a38518b06f9787b7c1f">sgpp::base::HashGridPoint::getStandardCoordinate</a></div><div class="ttdeci">double getStandardCoordinate(size_t d) const</div><div class="ttdoc">determines the coordinate in a given dimension &quot;Standard&quot; means no bounding box (i....</div><div class="ttdef"><b>Definition</b> HashGridPoint.hpp:196</div></div>
<div class="ttc" id="amultHPX_8cpp_html_afaae4b3ccddbff855673417650052c63"><div class="ttname"><a href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a></div><div class="ttdeci">sgpp::base::DataVector alpha</div><div class="ttdef"><b>Definition</b> multHPX.cpp:40</div></div>
<div class="ttc" id="anamespacesgpp_1_1op__factory_html_a08b6aa545e0f57f47b5cfdafd4f781e4"><div class="ttname"><a href="namespacesgpp_1_1op__factory.html#a08b6aa545e0f57f47b5cfdafd4f781e4">sgpp::op_factory::createOperationHierarchisation</a></div><div class="ttdeci">base::OperationHierarchisation * createOperationHierarchisation(base::Grid &amp;grid)</div><div class="ttdoc">Factory method, returning an OperationHierarchisation for the grid at hand.</div><div class="ttdef"><b>Definition</b> BaseOpFactory.cpp:275</div></div>
</div><!-- fragment --><p>Now we compute and compare the quadrature using four different methods available in SG++. </p><div class="fragment"><div class="line">  <span class="comment">// direct quadrature</span></div>
<div class="line">  std::unique_ptr&lt;sgpp::base::OperationQuadrature&gt; opQ(</div>
<div class="line">      <a class="code hl_function" href="namespacesgpp_1_1op__factory.html#a47268ca1a1b5acdf750b23a8a3fd0fa2">sgpp::op_factory::createOperationQuadrature</a>(*<a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>));</div>
<div class="line">  <span class="keywordtype">double</span> res = opQ-&gt;doQuadrature(<a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;exact integral value:  &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Monte Carlo quadrature using 100000 paths</span></div>
<div class="line">  <a class="code hl_class" href="classsgpp_1_1base_1_1OperationQuadratureMC.html">sgpp::base::OperationQuadratureMC</a> opMC(*<a class="code hl_function" href="multHPX_8cpp.html#ae871abe991ec98e4b1c09a6eaa9f1ddc">grid</a>, 100000);</div>
<div class="line">  res = opMC.doQuadrature(<a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Monte Carlo value:     &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</div>
<div class="line">  res = opMC.doQuadrature(<a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Monte Carlo value:     &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Monte Carlo quadrature of a function</span></div>
<div class="line">  res = opMC.doQuadratureFunc(<a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>, <span class="keyword">nullptr</span>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;MC value:              &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Monte Carlo quadrature of error</span></div>
<div class="line">  res = opMC.doQuadratureL2Error(<a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="multHPX_8cpp.html#afaae4b3ccddbff855673417650052c63">alpha</a>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;MC L2-error:           &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</div>
<div class="line">}  <span class="comment">// end of main</span></div>
<div class="ttc" id="aclasssgpp_1_1base_1_1OperationQuadratureMC_html"><div class="ttname"><a href="classsgpp_1_1base_1_1OperationQuadratureMC.html">sgpp::base::OperationQuadratureMC</a></div><div class="ttdoc">Quadrature on any sparse grid (that has OperationMultipleEval implemented) using Monte Carlo.</div><div class="ttdef"><b>Definition</b> OperationQuadratureMC.hpp:32</div></div>
<div class="ttc" id="anamespacesgpp_1_1op__factory_html_a47268ca1a1b5acdf750b23a8a3fd0fa2"><div class="ttname"><a href="namespacesgpp_1_1op__factory.html#a47268ca1a1b5acdf750b23a8a3fd0fa2">sgpp::op_factory::createOperationQuadrature</a></div><div class="ttdeci">base::OperationQuadrature * createOperationQuadrature(base::Grid &amp;grid)</div><div class="ttdoc">Factory method, returning an OperationQuadrature for the grid at hand.</div><div class="ttdef"><b>Definition</b> BaseOpFactory.cpp:345</div></div>
</div><!-- fragment --><p>This results in an output similar to: </p><pre class="fragment">dimensionality:        2
number of grid points: 17
exact integral value:  0.421875
Monte Carlo value:     0.421298
Monte Carlo value:     0.421971
MC value:              0.444917
MC L2-error:           0.0242639
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="examples.html">Usage Examples</a></li><li class="navelem"><a class="el" href="examples_cpp.html">C++ Examples</a></li>
    <li class="footer">Generated on Thu Feb 13 2025 14:36:16 for SG++-Doxygen-Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
