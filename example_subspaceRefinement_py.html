<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SG++-Doxygen-Documentation: Dimension-Adaptive Refinement in Python</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
  TeX: {
    Macros: {
      vec: ["\\boldsymbol{#1}", 1],
      opt: "\\mathrm{opt}",
      norm: ["\\lVert{#1}\\rVert", 1]
    }
  }
}); 
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sgpp_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">SG++-Doxygen-Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('example_subspaceRefinement_py.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Dimension-Adaptive Refinement in Python</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We compute the sparse grid interpolant of the function \( f(x) =
 \sin(10x_0)+x_1.\) We perform dimension-adaptive refinement of the sparse grid model, which means we add a complete hierarchical subspace in some dimensions.</p>
<p>For details on dimension-adaptive refinement see </p><pre class="fragment"> Hegland, M. Adaptive sparse grids, ANZIAM Journal, 2003, 44, C335-C353</pre><p>The example can be found in the file <code>subspaceRefinement.py</code>. </p><div class="fragment"><div class="line"><span class="comment"># import modules</span></div>
<div class="line"><span class="keyword">import</span> sys</div>
<div class="line"><span class="keyword">import</span> math</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> pysgpp <span class="keyword">import</span> *</div>
</div><!-- fragment --><p>We define the function \( f(x) =
 \sin(10x_0)+x_1\) to interpolate. </p><div class="fragment"><div class="line">f = <span class="keyword">lambda</span> x0, x1: math.sin(x0*10)+x1</div>
<div class="line"> </div>
</div><!-- fragment --><p>create a two-dimensional piecewise bi-linear grid </p><div class="fragment"><div class="line">dim = 2</div>
<div class="line">grid = Grid.createLinearGrid(dim)</div>
<div class="line">HashGridStorage = grid.getStorage()</div>
<div class="line">print(<span class="stringliteral">&quot;dimensionality:                   {}&quot;</span>.format(dim))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># create regular grid, level 3</span></div>
<div class="line">level = 3</div>
<div class="line">gridGen = grid.getGenerator()</div>
<div class="line">gridGen.regular(level)</div>
<div class="line">print(<span class="stringliteral">&quot;number of initial grid points:    {}&quot;</span>.format(HashGridStorage.getSize()))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># create coefficient vectors</span></div>
<div class="line">alpha = DataVector(HashGridStorage.getSize())</div>
<div class="line">print(<span class="stringliteral">&quot;length of alpha vector:           {}&quot;</span>.format(alpha.getSize()))</div>
<div class="line"> </div>
</div><!-- fragment --><p>To create a dataset we use points on a regular 2d grid with a step size of 1 / rows and 1 / cols. </p><div class="fragment"><div class="line">rows = 100</div>
<div class="line">cols = 100</div>
<div class="line"> </div>
<div class="line">dataSet = DataMatrix(rows*cols,dim)</div>
<div class="line">vals = DataVector(rows*cols)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(rows):</div>
<div class="line">    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(cols):</div>
<div class="line">        <span class="comment">#xcoord</span></div>
<div class="line">        dataSet.set(i*cols+j,0,i*1.0/rows)</div>
<div class="line">        <span class="comment">#ycoord</span></div>
<div class="line">        dataSet.set(i*cols+j,1,j*1.0/cols)</div>
<div class="line">        vals[i*cols+j] = <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(i*1.0/rows,j*1.0/cols)</div>
<div class="ttc" id="aAugmentedLagrangian_8cpp_html_ac2eaf9e806b463971eb23d43900a64be"><div class="ttname"><a href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a></div><div class="ttdeci">base::ScalarFunction &amp; f</div><div class="ttdef"><b>Definition</b> AugmentedLagrangian.cpp:75</div></div>
</div><!-- fragment --><p>We refine adaptively 20 times. In every step we recompute the vector of surpluses <code>alpha</code>, the vector with squared errors on the dataset <code>errorVector</code>, and then call the refinement routines.</p>
<div class="fragment"><div class="line"><span class="comment"># create coefficient vectors</span></div>
<div class="line">alpha = DataVector(HashGridStorage.getSize())</div>
<div class="line">print(<span class="stringliteral">&quot;length of alpha vector:           {}&quot;</span>.format(alpha.getSize()))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># now refine adaptively 2 times</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> refnum <span class="keywordflow">in</span> range(2):</div>
</div><!-- fragment --><p>Step 1: calculate the surplus vector alpha. In data mining we do it by solving a regression problem. Here, the function can be evaluated at any point. Hence. we simply evaluate it at the coordinates of the grid points to obtain the nodal values. Then we use hierarchization to obtain the surplus value. </p><div class="fragment"><div class="line">    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(HashGridStorage.getSize()):</div>
<div class="line">        gp = HashGridStorage.getPoint(i)</div>
<div class="line">        alpha[i] = <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(gp.getStandardCoordinate(0), gp.getStandardCoordinate(1))</div>
<div class="line"> </div>
<div class="line">    <span class="comment"># hierarchize</span></div>
<div class="line">    createOperationHierarchisation(grid).doHierarchisation(alpha)</div>
</div><!-- fragment --><p>Step 2: call refinement routines. <code>PredictiveRefinement</code> implements the decorator pattern and extends the functionality of <code>ANOVAHashRefinement</code>. <code>PredictiveRefinement</code> requires a special kind of refinement functor &ndash; <code>PredictiveRefinementIndicator</code> that can access the dataset and the error vector. The refinement itself if performed by calling <code>.free_refine()</code> same for normal refinement in <code>ANOVAHashRefinement</code>. <code>ANOVAHashRefinement</code> creates new grid points only in the dimensions where the parent has level greater 1. </p><div class="fragment"><div class="line">    <span class="comment">#refinement  stuff</span></div>
<div class="line">    refinement = HashRefinement()</div>
<div class="line">    decorator = SubspaceRefinement(refinement)</div>
<div class="line">    functor = SurplusRefinementFunctor(alpha,1)</div>
<div class="line">    decorator.free_refine(HashGridStorage,functor)</div>
<div class="line"> </div>
<div class="line">    print(<span class="stringliteral">&quot;Refinement step %d, new grid size: %d&quot;</span> % (refnum+1, HashGridStorage.getSize()))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment"># extend alpha vector (new entries uninitialized)</span></div>
<div class="line">    alpha.resizeZero(HashGridStorage.getSize())</div>
</div><!-- fragment --><p>The output of the program should look like this</p>
<pre class="fragment"> dimensionality:                   2
 number of initial grid points:    17
 length of alpha vector:           17
 length of alpha vector:           17
 Refinement step 1, new grid size: 33
 Refinement step 2, new grid size: 73</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="examples.html">Usage Examples</a></li><li class="navelem"><a class="el" href="examples_py.html">Python Examples</a></li>
    <li class="footer">Generated on Thu Feb 13 2025 14:24:10 for SG++-Doxygen-Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
