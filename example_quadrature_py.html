<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SG++-Doxygen-Documentation: Quadrature in Python</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
  TeX: {
    Macros: {
      vec: ["\\boldsymbol{#1}", 1],
      opt: "\\mathrm{opt}",
      norm: ["\\lVert{#1}\\rVert", 1]
    }
  }
}); 
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sgpp_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">SG++-Doxygen-Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('example_quadrature_py.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Quadrature in Python</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The following example shows how to integrate in SG++, using both direct integration of a sparse grid function and the use of Monte Carlo integration.</p>
<p>As in the <a class="el" href="example_tutorial_py.html">tutorial.py (Start Here)</a> example, we deal with the function  </p><p class="formulaDsp">
\[
   f\colon [0, 1]^2 \to \mathbb{R},\quad
   f(x_0, x_1) := 16 (x_0 - 1) x_0 (x_1 - 1) x_1
 \]
</p>
<p> which we first interpolate. We then integrate the interpolant, then the function itself using 100000 Monte Carlo points, and we then compute the L2-error.</p>
<p>The function, which <a class="el" href="classsgpp_1_1base_1_1OperationQuadratureMC.html" title="Quadrature on any sparse grid (that has OperationMultipleEval implemented) using Monte Carlo.">sgpp::base::OperationQuadratureMC</a> takes, has one parameter, a sequence (C++ provides a tuple) with the coordinates of the grid point \(\in [0,1]^d\). </p><div class="fragment"><div class="line"><span class="comment"># import pysgpp library</span></div>
<div class="line"><span class="keyword">import</span> pysgpp</div>
<div class="line"> </div>
<div class="line"><span class="comment"># the standard parabola (arbitrary-dimensional)</span></div>
<div class="line"><span class="keyword">def </span><a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(x):</div>
<div class="line">  res = 1.0</div>
<div class="line">  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(x)):</div>
<div class="line">    res *= 4.0*x[i]*(1.0-x[i])</div>
<div class="line">  <span class="keywordflow">return</span> res</div>
<div class="line"> </div>
<div class="line"><span class="comment"># a pyramid-like shape (arbitrary-dimensional)</span></div>
<div class="line"><span class="keyword">def </span><a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#a39d87577cea594685acd774aa77528bd">g</a>(x):</div>
<div class="line">  res = 1.0</div>
<div class="line">  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(x)):</div>
<div class="line">    res *= 2.0*min(x[i], 1.0-x[i])</div>
<div class="line">  <span class="keywordflow">return</span> res</div>
<div class="line"> </div>
<div class="ttc" id="aAugmentedLagrangian_8cpp_html_a39d87577cea594685acd774aa77528bd"><div class="ttname"><a href="AugmentedLagrangian_8cpp.html#a39d87577cea594685acd774aa77528bd">g</a></div><div class="ttdeci">base::VectorFunction &amp; g</div><div class="ttdef"><b>Definition</b> AugmentedLagrangian.cpp:76</div></div>
<div class="ttc" id="aAugmentedLagrangian_8cpp_html_ac2eaf9e806b463971eb23d43900a64be"><div class="ttname"><a href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a></div><div class="ttdeci">base::ScalarFunction &amp; f</div><div class="ttdef"><b>Definition</b> AugmentedLagrangian.cpp:75</div></div>
</div><!-- fragment --><p>Create a two-dimensional piecewise bi-linear grid of level 3 </p><div class="fragment"><div class="line">dim = 2</div>
<div class="line">grid = pysgpp.Grid.createLinearGrid(dim)</div>
<div class="line">gridStorage = grid.getStorage()</div>
<div class="line">print(<span class="stringliteral">&quot;dimensionality:        {}&quot;</span>.format(dim))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># create regular grid, level 3</span></div>
<div class="line">level = 3</div>
<div class="line">gridGen = grid.getGenerator()</div>
<div class="line">gridGen.regular(level)</div>
<div class="line">print(<span class="stringliteral">&quot;number of grid points: {}&quot;</span>.format(gridStorage.getSize()))</div>
<div class="line"> </div>
</div><!-- fragment --><p>Calculate the surplus vector alpha for the interpolant of \(
 f(x)\). Since the function can be evaluated at any point. Hence. we simply evaluate it at the coordinates of the grid points to obtain the nodal values. Then we use hierarchization to obtain the surplus value. </p><div class="fragment"><div class="line"><span class="comment"># create coefficient vector</span></div>
<div class="line">alpha = pysgpp.DataVector(gridStorage.getSize())</div>
<div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(gridStorage.getSize()):</div>
<div class="line">  gp = gridStorage.getPoint(i)</div>
<div class="line">  p = tuple([gp.getStandardCoordinate(j) <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(dim)])</div>
<div class="line">  alpha[i] = <a class="code hl_variable" href="AugmentedLagrangian_8cpp.html#ac2eaf9e806b463971eb23d43900a64be">f</a>(p)</div>
<div class="line"> </div>
<div class="line">pysgpp.createOperationHierarchisation(grid).doHierarchisation(alpha)</div>
<div class="line"> </div>
</div><!-- fragment --><p>Now we compute and compare the quadrature using four different methods available in SG++. </p><div class="fragment"><div class="line"><span class="comment"># direct quadrature</span></div>
<div class="line">opQ = pysgpp.createOperationQuadrature(grid)</div>
<div class="line">res = opQ.doQuadrature(alpha)</div>
<div class="line">print(<span class="stringliteral">&quot;exact integral value:  {}&quot;</span>.format(res))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Monte Carlo quadrature using 100000 paths</span></div>
<div class="line">opMC = pysgpp.OperationQuadratureMC(grid, 100000)</div>
<div class="line">res = opMC.doQuadrature(alpha)</div>
<div class="line">print(<span class="stringliteral">&quot;Monte Carlo value:     {:.6f}&quot;</span>.format(res))</div>
<div class="line">res = opMC.doQuadrature(alpha)</div>
<div class="line">print(<span class="stringliteral">&quot;Monte Carlo value:     {:.6f}&quot;</span>.format(res))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Monte Carlo quadrature of a standard parabola</span></div>
<div class="line">res = opMC.doQuadratureFunc(f)</div>
<div class="line">print(<span class="stringliteral">&quot;MC value (f):          {:.6f}&quot;</span>.format(res))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Monte Carlo quadrature of error</span></div>
<div class="line">res = opMC.doQuadratureL2Error(f, alpha)</div>
<div class="line">print(<span class="stringliteral">&quot;MC L2-error (f-u)      {:.7f}&quot;</span>.format(res))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Monte Carlo quadrature of a piramidal function</span></div>
<div class="line">res = opMC.doQuadratureFunc(g)</div>
<div class="line">print( <span class="stringliteral">&quot;MC value (g):          {:.6f}&quot;</span>.format(res))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Monte Carlo quadrature of error</span></div>
<div class="line">res = opMC.doQuadratureL2Error(g, alpha)</div>
<div class="line">print( <span class="stringliteral">&quot;MC L2-error (g-u)      {:.7f}&quot;</span>.format(res))</div>
</div><!-- fragment --><p>This results in an output similar to: </p><pre class="fragment">dimensionality:        2
number of grid points: 17
exact integral value:  0.421875
Monte Carlo value:     0.421298
Monte Carlo value:     0.421971
MC value:              0.444917
MC L2-error:           0.0242639
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="examples.html">Usage Examples</a></li><li class="navelem"><a class="el" href="examples_py.html">Python Examples</a></li>
    <li class="footer">Generated on Thu Feb 13 2025 14:24:10 for SG++-Doxygen-Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
